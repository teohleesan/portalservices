"use strict";(self.webpackChunkPortal=self.webpackChunkPortal||[]).push([[66],{3066:(ce,k,l)=>{l.r(k),l.d(k,{InvoiceModule:()=>se});var g=l(9808),W=l(224),z=l(4253),x=l(9826),P=l(655),f=l(2062),A=l(4987),t=l(5e3),_=l(3038),K=l(2802),q=l(2638),X=l(2354);const tt=["endSnav"],et=["startSnav"];let y=class{constructor(n,e){this.actionService=n,this.renderer2=e,this.title="Invoice",this.openSidebar=!0,this.openStartSidebar=!1,this.id="",this.guidEmpty=f.i.empty,this.mediaMatcher=matchMedia("(max-width : 720px)")}ngOnInit(){this.subscription=this.actionService.toggleDataEvent.pipe((0,A.t)(this)).subscribe(n=>{this.update(n)})}ngAfterViewInit(){}update(n){this.id=(null==n?void 0:n.id)?n.id:""}isScreenSmall(){return this.mediaMatcher.matches}optionsEvent(n){}};y.\u0275fac=function(n){return new(n||y)(t.Y36(_.cw),t.Y36(t.Qsj))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-invoice-layout"]],viewQuery:function(n,e){if(1&n&&(t.Gf(tt,5),t.Gf(et,5)),2&n){let a;t.iGM(a=t.CRH())&&(e.endSnav=a.first),t.iGM(a=t.CRH())&&(e.startSnav=a.first)}},decls:5,vars:1,consts:[[3,"title"],[1,"demo-sidenav-container"],["role","region",1,"demo-sidenav-content",2,"width","100%","overflow","hidden"],[3,"optionsEvent"]],template:function(n,e){1&n&&(t._UZ(0,"app-page-header",0),t.TgZ(1,"mat-sidenav-container",1)(2,"mat-sidenav-content",2),t._UZ(3,"router-outlet"),t.TgZ(4,"app-float-button",3),t.NdJ("optionsEvent",function(i){return e.optionsEvent(i)}),t.qZA()()()),2&n&&t.Q6J("title",e.title)},directives:[K.q,q.TM,q.Rh,x.lC,X.u],styles:[".demo-sidenav-spacer[_ngcontent-%COMP%]{flex:1}mat-sidenav.demo-sidenav-playlist[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.demo-sidenav-playlist-header[_ngcontent-%COMP%]{text-align:center}@media (max-width: 599px){mat-sidenav.demo-sidenav-playlist[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}}",".demo-sidenav-app[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}.demo-sidenav-container[_ngcontent-%COMP%]{flex:1;overflow:hidden}.demo-sidenav-container-fixed[_ngcontent-%COMP%]{flex:none}h1.demo-sidenav-app-name[_ngcontent-%COMP%]{margin-left:8px}button.demo-sidenav-close[_ngcontent-%COMP%]{margin:20px}.demo-sidenav-filler[_ngcontent-%COMP%]{margin:100px 20px}"]}),y=(0,P.gn)([(0,A.c)()],y);var ot=l(1135),it=l(8372),c=l(3075),Z=l(5439),h=l(4999),J=l(8966),Q=l(520),L=l(5101);class F{constructor(){this.id=f.i.empty,this.invoiceNumber="",this.invoiceDate=new Date,this.dueDate=new Date,this.category="",this.customerId=null,this.customer="",this.billAddress="",this.billCity="",this.billRegion="",this.billPostalCode="",this.billCountry="",this.billPhoneNumber="",this.shipAddress="",this.shipCity="",this.shipRegion="",this.shipPostalCode="",this.shipCountry="",this.shipPhoneNumber="",this.currencyId=null,this.currency="",this.subTotal=0,this.discountPercent=0,this.discountAmount=0,this.totalDiscountAmount=0,this.totalAmountAfterDiscount=0,this.amountAfterDiscount=0,this.taxPercent=7,this.taxAmount=0,this.totalAmount=0,this.paymentMethodId=null,this.paymentMethod="",this.paymentTerm=30,this.remark="",this.overDueDays=0,this.payedAmount=0,this.outStandingAmount=0,this.invoiceItems=Array()}}class V{constructor(){this.id=f.i.empty,this.invoiceId=f.i.empty,this.invoiceLineNumber=0,this.name="",this.unitPrice=0,this.quantity=0,this.amount=0,this.discountPercent=0,this.discountAmount=0,this.totalDiscountAmount=0,this.netAmount=0,this.remark=""}}var at=l(13),$=l(4241),rt=l(9256),N=l(4652),E=l(5518),O=l(3606),st=l(972),T=l(7093),I=l(3489),w=l(3322),lt=l(8833),Y=l(1079),ct=l(7423),mt=l(5245),R=l(508),U=l(6856),ut=l(6744),G=l(9814),B=l(9224),pt=l(7238),dt=l(7067),H=l(1470),D=l(2181),ht=l(9285);function ft(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(i){t.CHM(e);const r=t.oxw(),s=t.MAs(9);return r.clearInput(i,"customer",s)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function vt(o,n){if(1&o&&(t.TgZ(0,"mat-option",101),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function gt(o,n){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function _t(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,gt,3,1,"ng-container",102),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("customer").errors,"customer"))}}function yt(o,n){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function bt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,yt,3,1,"ng-container",102),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("invoiceNumber").errors,"invoiceNumber"))}}function xt(o,n){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function At(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,xt,3,1,"ng-container",102),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("invoiceDate").errors,"invoiceDate"))}}function It(o,n){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Ct(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,It,3,1,"ng-container",102),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("dueDate").errors,"dueDate"))}}function Zt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(i){t.CHM(e);const r=t.oxw(),s=t.MAs(58);return r.clearInput(i,"currency",s)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function Tt(o,n){if(1&o&&(t.TgZ(0,"mat-option",101),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function Mt(o,n){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function St(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,Mt,3,1,"ng-container",102),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("currency").errors,"currency"))}}function Nt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(i){t.CHM(e);const r=t.oxw(),s=t.MAs(73);return r.clearInput(i,"paymentMethod",s)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function wt(o,n){if(1&o&&(t.TgZ(0,"mat-option",101),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function Ut(o,n){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=n.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Dt(o,n){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,Ut,3,1,"ng-container",102),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("paymentMethod").errors,"paymentMethod"))}}function kt(o,n){1&o&&t._UZ(0,"th",103)}const Pt=function(o){return{"bg-green-600":o}};function qt(o,n){if(1&o&&(t.TgZ(0,"td",104)(1,"span",105),t._uU(2),t.qZA()()),2&o){const e=n.$implicit,a=n.dataIndex,i=t.oxw();t.Q6J("formGroup",e)("ngClass",t.VKq(4,Pt,i.lockLineItem==a)),t.uIk("rowspan",2),t.xp6(2),t.hij(" ",a+1," ")}}function Jt(o,n){1&o&&t._UZ(0,"th",103)}function Qt(o,n){1&o&&(t.TgZ(0,"td",106)(1,"mat-form-field",107)(2,"mat-label"),t._uU(3,"Name"),t.qZA(),t._UZ(4,"input",108),t.qZA()()),2&o&&(t.Q6J("formGroup",n.$implicit),t.uIk("colspan",2))}function Lt(o,n){1&o&&t._UZ(0,"th",103)}function Ft(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",109)(1,"mat-form-field",110)(2,"mat-label"),t._uU(3,"Unit/Price"),t.qZA(),t.TgZ(4,"input",111),t.NdJ("keyup",function(i){const s=t.CHM(e).$implicit;return t.oxw().onItemValueChanges(i,s)}),t.qZA(),t.TgZ(5,"span",112),t._uU(6,"$"),t.qZA()()()}2&o&&t.Q6J("formGroup",n.$implicit)}function Vt(o,n){1&o&&(t.TgZ(0,"th",103),t._uU(1,"Quantity"),t.qZA())}function $t(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",109)(1,"mat-form-field",110)(2,"mat-label"),t._uU(3,"Quantity"),t.qZA(),t.TgZ(4,"input",113),t.NdJ("keyup",function(i){const s=t.CHM(e).$implicit;return t.oxw().onItemValueChanges(i,s)}),t.qZA()()()}2&o&&t.Q6J("formGroup",n.$implicit)}function Et(o,n){1&o&&(t.TgZ(0,"th",103),t._uU(1,"Amount"),t.qZA())}function Ot(o,n){1&o&&(t.TgZ(0,"td",109)(1,"mat-form-field",110)(2,"mat-label"),t._uU(3,"Amount"),t.qZA(),t._UZ(4,"input",114),t.TgZ(5,"span",112),t._uU(6,"$"),t.qZA()()()),2&o&&t.Q6J("formGroup",n.$implicit)}function Yt(o,n){1&o&&(t.TgZ(0,"th",103),t._uU(1," Actions"),t.qZA())}function Rt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",119),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),r=i.dataIndex,s=i.$implicit;return t.oxw().editLineItem(r,s)}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Edit"),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.Q6J("disabled",e.controls.disableEditButton.value)}}function Gt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",119),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),r=i.dataIndex,s=i.$implicit;return t.oxw().cancelEditLineItem(r,s)}),t.TgZ(1,"mat-icon"),t._uU(2,"undo"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Cancel"),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.Q6J("disabled",e.controls.disableCancelButton.value)}}function Bt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"button",119),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),r=i.dataIndex,s=i.$implicit;return t.oxw().updateLineItem(r,s)}),t.TgZ(1,"mat-icon"),t._uU(2,"save"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Save"),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.Q6J("disabled",e.controls.disableSaveButton.value)}}function Ht(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",115)(1,"button",116)(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,117),t.YNc(6,Rt,5,1,"button",118),t.YNc(7,Gt,5,1,"button",118),t.YNc(8,Bt,5,1,"button",118),t.TgZ(9,"button",119),t.NdJ("click",function(){const i=t.CHM(e),r=i.dataIndex,s=i.$implicit;return t.oxw().deleteLineItem(r,s)}),t.TgZ(10,"mat-icon"),t._uU(11,"delete"),t.qZA(),t.TgZ(12,"span"),t._uU(13,"Delete"),t.qZA()()()()}if(2&o){const e=n.$implicit,a=n.dataIndex,i=t.MAs(5),r=t.oxw();t.Q6J("formGroup",e),t.uIk("rowspan",2),t.xp6(1),t.Q6J("matMenuTriggerFor",i)("disabled",r.lockLineItem!==a&&null!==r.lockLineItem),t.xp6(5),t.Q6J("ngIf",!r.createMode$.getValue()),t.xp6(1),t.Q6J("ngIf",!r.createMode$.getValue()),t.xp6(1),t.Q6J("ngIf",!r.createMode$.getValue()),t.xp6(1),t.Q6J("disabled",e.controls.disableDeleteButton.value&&!r.createMode$.getValue())}}function jt(o,n){1&o&&(t.TgZ(0,"td",120)(1,"mat-form-field",121)(2,"mat-label"),t._uU(3,"Remark"),t.qZA(),t._UZ(4,"input",122),t.qZA()()),2&o&&t.Q6J("formGroup",n.$implicit)}const b=function(){return{color:"red"}};function Wt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",123)(1,"mat-form-field",124)(2,"mat-label"),t._uU(3,"Discount %"),t.qZA(),t.TgZ(4,"input",125),t.NdJ("keyup",function(i){const s=t.CHM(e).$implicit;return t.oxw().onItemValueChanges(i,s)}),t.qZA(),t.TgZ(5,"span",126),t._uU(6,"%"),t.qZA()()()}if(2&o){const e=n.$implicit,a=n.dataIndex,i=t.oxw();t.Q6J("formGroup",e),t.xp6(1),t.Q6J("ngStyle",i.invoiceItems.at(a).get("totalDiscountAmount").invalid&&(i.invoiceItems.at(a).get("discountPercent").dirty||i.invoiceItems.at(a).get("discountPercent").touched)&&t.DdM(2,b))}}function zt(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"td",120)(1,"mat-form-field",127)(2,"mat-label"),t._uU(3,"Discount $"),t.qZA(),t.TgZ(4,"input",128),t.NdJ("keyup",function(i){const s=t.CHM(e).$implicit;return t.oxw().onItemValueChanges(i,s)}),t.qZA(),t.TgZ(5,"span",112),t._uU(6,"$"),t.qZA()()()}if(2&o){const e=n.$implicit,a=n.dataIndex,i=t.oxw();t.Q6J("formGroup",e),t.xp6(1),t.Q6J("ngStyle",i.invoiceItems.at(a).get("totalDiscountAmount").invalid&&(i.invoiceItems.at(a).get("discountAmount").dirty||i.invoiceItems.at(a).get("discountAmount").touched)&&t.DdM(2,b))}}function Kt(o,n){if(1&o&&(t.TgZ(0,"td",120)(1,"mat-form-field",129)(2,"mat-label"),t._uU(3,"Total Discount Amount $"),t.qZA(),t._UZ(4,"input",130),t.TgZ(5,"span",112),t._uU(6,"$"),t.qZA()()()),2&o){const e=n.$implicit,a=n.dataIndex,i=t.oxw();t.Q6J("formGroup",e),t.xp6(1),t.Q6J("ngStyle",i.invoiceItems.at(a).get("totalDiscountAmount").invalid&&t.DdM(2,b))}}function Xt(o,n){if(1&o&&(t.TgZ(0,"td",120)(1,"mat-form-field",129)(2,"mat-label"),t._uU(3,"Item Amount"),t.qZA(),t._UZ(4,"input",131),t.TgZ(5,"span",112),t._uU(6,"$"),t.qZA()()()),2&o){const e=n.$implicit,a=n.dataIndex,i=t.oxw();t.Q6J("formGroup",e),t.xp6(1),t.Q6J("ngStyle",i.invoiceItems.at(a).get("netAmount").invalid&&t.DdM(3,b)),t.xp6(3),t.Q6J("allowNegativeNumbers",!0)}}const j=function(o){return{"mat-table-multiple-focus":o}};function te(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"tr",132),t.NdJ("mouseenter",function(){const r=t.CHM(e).dataIndex;return t.oxw().currentLineItem=r})("mouseleave",function(){return t.CHM(e),t.oxw().currentLineItem=-1}),t.qZA()}if(2&o){const e=n.dataIndex,a=t.oxw();t.Q6J("ngClass",t.VKq(1,j,a.currentLineItem===e))}}function ee(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"tr",132),t.NdJ("mouseenter",function(){const r=t.CHM(e).dataIndex;return t.oxw().currentLineItem=r})("mouseleave",function(){return t.CHM(e),t.oxw().currentLineItem=-1}),t.qZA()}if(2&o){const e=n.dataIndex,a=t.oxw();t.Q6J("ngClass",t.VKq(1,j,a.currentLineItem===e))}}const ne=function(o){return{"mat-form-field-disable":o}},M=function(o){return["text-white",o]};let v=class{constructor(n,e,a,i,r,s,m,u,d,p,S,C){this.fb=n,this.httpService=e,this.sessionService=a,this.router=i,this.activatedRoute=r,this.toastrService=s,this.actionService=m,this.lookupService=u,this.dialog=d,this.reactiveformService=p,this.itemsService=S,this.fileService=C,this.backUpLineItem=null,this.title="Invoice Maintenance",this.customerAutoComplete$=null,this.currencyAutoComplete$=null,this.paymentMethodComplete$=null,this.selectedCurrency=null,this.selectedCustomer=null,this.selectedPaymentMethod=null,this.createMode=!0,this.createMode$=new ot.X(!0),this._createMode$=this.createMode$.asObservable(),this.id="",this.taxPercent=7,this.currentLineItem=null,this.lockLineItem=null,this.firstLineColumns=["lineItemNumber","name","unitPrice","quantity","amount","actions"],this.secondLineColumns=["remark","discountPercent","discountAmount","totalDiscountAmount","netAmount"],this.payAmount=0,this.outStandingAmount=0,this.overDueDays=0,this.color=["bg-cyan-500","bg-blue-500","bg-green-500","bg-deep-orange-500"]}ngOnInit(){this.initialize(),this.initializeForm(new F),this.initializeToolbar(),this._createMode$.pipe((0,A.t)(this)).subscribe(n=>{this.toolbarModel.showDownload=!n,this.actionService.setToolbarSettings(this.toolbarModel)}),this.routerSubscription=this.activatedRoute.queryParams.subscribe(n=>{this.id=n.id||"",this.id.length>0&&this.get(this.id)}),this.updateEventSubscription=this.actionService.toggleUpdateEvent.subscribe(n=>this.update(n)),this.createNewEventSubscription=this.actionService.toggleCreateEvent.subscribe(n=>this.create(n)),this.getEventSubscription=this.actionService.toggleGetEvent.subscribe(n=>{this.id=n,this.get(this.id)}),this.downloadEventSubscription=this.actionService.toggleDownloadEvent.subscribe(n=>this.download(n)),this.form.valueChanges.pipe((0,it.b)(500),(0,E.Lr)(),(0,A.t)(this)).subscribe(n=>{this.actionService.formDirty=!(!this.form.valid||!this.form.touched&&!this.form.dirty)})}ngAfterViewInit(){this.initReferences()}ngOnDestroy(){this.updateEventSubscription.unsubscribe(),this.createNewEventSubscription.unsubscribe(),this.getEventSubscription.unsubscribe(),this.routerSubscription.unsubscribe(),this.downloadEventSubscription.unsubscribe()}initialize(){this.inquiry=new L.U,this.currencyArrow=this.customerArrow=this.paymentMethodArrow="arrow_drop_down",this.currencyObs=this.customerObs=this.paymentMethodObs=!1}initializeForm(n){this.form=this.fb.group({id:[n.id],invoiceNumber:[n.invoiceNumber,[c.kI.maxLength(50),c.kI.required]],invoiceDate:[n.invoiceDate,c.kI.required],dueDate:[n.dueDate,c.kI.required],billAddress:[n.billAddress],billCity:[n.billCity],billRegion:[n.billRegion],billPostalCode:[n.billPostalCode],billCountry:[n.billCountry],billPhoneNumber:[n.billPhoneNumber],shipAddress:[n.shipAddress],shipCity:[n.shipCity],shipRegion:[n.shipRegion],shipPostalCode:[n.shipPostalCode],shipCountry:[n.shipCountry],shipPhoneNumber:[n.shipPhoneNumber],currencyId:[n.currencyId,c.kI.required],currency:[n.currency,c.kI.required],paymentMethodId:[n.paymentMethodId,c.kI.required],paymentMethod:[n.paymentMethod,c.kI.required],customerId:[n.customerId,c.kI.required],customer:[n.customer,c.kI.required],discountPercent:[n.discountPercent,[c.kI.min(0),c.kI.max(100)]],discountAmount:[n.discountAmount,c.kI.min(0)],totalDiscountAmount:[{value:n.totalDiscountAmount,disabled:!0},[c.kI.min(0),N.O.greaterThanOrEqualTo("subTotal")]],amountAfterDiscount:[{value:n.amountAfterDiscount,disabled:!0},c.kI.min(0)],taxPercent:[n.taxPercent,[c.kI.min(0),c.kI.max(100)]],subTotal:[{value:n.subTotal,disabled:!0}],taxAmount:[{value:n.taxAmount,disabled:!0},c.kI.min(0)],totalAmount:[n.totalAmount,[c.kI.min(0),this.validatePaymentAmount()]],paymentTerm:[n.paymentTerm,c.kI.required],category:[n.category]}),this.formArray=this.fb.group({invoiceItems:this.fb.array([])}),this.dataSource=new h.by(this.invoiceItems.controls),this.changePaymentTerm()}validatePaymentAmount(){return n=>n.value&&this.payAmount>n.value?{exceed:!0}:null}initializeToolbar(){this.toolbarModel=new rt.P,this.toolbarModel.showNavigatebefore=!0,this.toolbarModel.showSave=!0,this.toolbarModel.title=this.title,this.toolbarModel.navigatebeforeUrl="/invoicemanagement/invoice/inquiry",this.actionService.setToolbarSettings(this.toolbarModel)}get(n){this.createMode$.next(!1);const e=(new Q.LE).set("id",n);this.httpService.HttpGetWithParams(this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/get",e).subscribe(i=>{this.getSuccess(i)},i=>this.getFailed(i))}getSuccess(n){this.id=n.entity.id;let e=n.entity;this.reactiveformService.setReactiveFormObject(this.form,e),this.form.get("paymentTerm").patchValue(e.paymentTerm&&null!==e.paymentTerm?e.paymentTerm:30),this.form.get("category").patchValue(e.category&&null!==e.category?e.category.toString():"P"),this.invoiceItems.clear(),n.entity.invoiceItems.forEach((i,r)=>{this.invoiceItems.push(this.addItem(i,!1))}),this.invoiceItems.disable({onlySelf:!0,emitEvent:!1}),this.dataSource._updateChangeSubscription(),this.patchAutoComplete(n.entity),this.summary(n),this.actionService.toggleDataEvent.emit(n.entity)}getFailed(n){}create(n){this.id="",this.reactiveformService.setReactiveFormObject(this.form,new F),this.invoiceItems.clear(),this.dataSource=new h.by(this.invoiceItems.controls),this.dataSource._updateChangeSubscription(),this.changePaymentTerm(),this.patchAutoComplete(null),this.currencyObs=this.customerObs=this.paymentMethodObs=!0,this.createMode$.next(!0),this.payAmount=this.outStandingAmount=this.overDueDays=0,this.actionService.toggleDataEvent.emit(null)}update(n){let e=this.reactiveformService.getReactiveFormObject(this.form);delete e.currency,delete e.paymentMethod,delete e.customer;let a="";a=e.id===f.i.empty||""===e.id?this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/create":this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/update",e.invoiceItems=this.getItems(),e.invoiceItems.length<1?this.toastrService.ShowWarningMessage("Please enter at least 1 item."):this.httpService.HttpPost(a,e).subscribe(i=>{this.updateSuccess(i)},i=>this.updateFailed(i))}get invoiceItems(){return this.formArray.get("invoiceItems")}getItems(){let n=new Array,e=new V;for(let a=0;a<this.invoiceItems.length;a++)e=this.itemsService.getSerialized(this.invoiceItems.controls[a].value),n.push(e);return n}updateSuccess(n){this.id=n.entity.id,this.invoiceItems.clear(),n.entity.invoiceItems.forEach(a=>{this.invoiceItems.push(this.addItem(a,!1))}),this.dataSource._updateChangeSubscription(),this.invoiceItems.disable({onlySelf:!0,emitEvent:!1}),this.toastrService.ShowSuccessMessage("Record successfully saved."),this.createMode$.next(!1),this.actionService.formDirty=!1}updateFailed(n){}removeLineItem(n,e){this.invoiceItems.removeAt(n),this.dataSource._updateChangeSubscription()}addItem(n,e){return this.fb.group({id:[n.id],invoiceId:[n.invoiceId,c.kI.required],invoiceLineNumber:[n.invoiceLineNumber],name:[n.name,c.kI.required],unitPrice:[n.unitPrice,[c.kI.required,c.kI.min(0)]],quantity:[n.quantity,[c.kI.required,c.kI.min(0)]],amount:[n.amount,c.kI.required],discountPercent:[n.discountPercent,[c.kI.min(0),c.kI.max(100)]],discountAmount:[n.discountAmount,[c.kI.min(0),N.O.greaterThanOrEqualTo("amount")]],totalDiscountAmount:[{value:n.totalDiscountAmount,disabled:!0},[c.kI.min(0),N.O.greaterThanOrEqualTo("amount")]],netAmount:[{value:n.netAmount,disabled:!0},[c.kI.required,c.kI.min(0)]],remark:[n.remark],disableEditButton:[e],disableCancelButton:[!e],disableSaveButton:[!e],disableDeleteButton:[e]})}insertLineItem(){this.createMode$.getValue()||!this.lockLineItem?(this.invoiceItems.push(this.addItem(new V,!0)),this.dataSource._updateChangeSubscription(),this.setFormArrayMenuButton(this.invoiceItems.controls.length-1,!0),this.createMode$.getValue()||(this.lockLineItem=this.invoiceItems.controls.length-1)):this.toastrService.ShowInfoMessage("Please save new added item.")}editLineItem(n,e){this.createMode$.getValue()||this.form.disable(),this.actionService.formDirty=!1,this.setFormArrayMenuButton(n,!0),this.backUpLineItem=e.value,this.lockLineItem=n}updateLineItem(n,e){if(this.invoiceItems.at(n).invalid)return void this.toastrService.ShowErrorMessage("Invalid input, please try again");let a=this.reactiveformService.getReactiveFormObject(e);a.invoiceId=this.id;let i="";i=a.id===f.i.empty||""===a.id?this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/createItemOnly":this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/updateItem",this.httpService.HttpPost(i,a).subscribe(r=>{this.updateLineItemSuccess(r,n,e)},r=>this.updateFailed(r))}updateLineItemSuccess(n,e,a){this.invoiceItems.at(e).get("id").patchValue(n.entity.id),this.form.enable(),this.setFormArrayMenuButton(e,!1),this.backUpLineItem=null,this.lockLineItem=null,this.toastrService.ShowSuccessMessage("Line Item successfully updated.")}cancelEditLineItem(n,e){this.form.enable(),this.actionService.formDirty=!1,this.backUpLineItem&&this.backUpLineItem.id===e.get("id").value&&(this.reactiveformService.setReactiveFormObject(this.invoiceItems.at(n),this.backUpLineItem),this.backUpLineItem=null),this.setFormArrayMenuButton(n,!1),this.lockLineItem=null;let a=e.get("id").value;(a===f.i.empty||0===a.length)&&this.removeLineItem(n,e)}deleteLineItem(n,e){const a=e.get("id").value;if(-1!==n){const i=new J.vA;i.autoFocus=!0,i.data=new at.B("Delete record?","Are you wants to delete this record","OK","Cancel",!1,null),this.dialog.open($.z,i).afterClosed().subscribe(s=>{if(!0===s){if(a===f.i.empty||""===a)return void this.removeLineItem(n,e);const m=a,u=(new Q.LE).set("id",m);this.httpService.HttpDelete(this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/deleteItem",u).subscribe(p=>{this.deleteLineItemSuccess(n)},p=>this.deleteLineItemFailed(p))}})}}deleteLineItemSuccess(n){this.invoiceItems.removeAt(n),this.dataSource._updateChangeSubscription(),this.toastrService.ShowSuccessMessage("Line Item successfully deleted.")}deleteLineItemFailed(n){}setFormArrayMenuButton(n,e){this.invoiceItems.disable();const a=e?"enable":"disable";this.invoiceItems.at(n)[a]({onlySelf:!0,emitEvent:!1}),this.invoiceItems.at(n).get("disableSaveButton").patchValue(!e),this.invoiceItems.at(n).get("disableCancelButton").patchValue(!e),this.invoiceItems.at(n).get("disableDeleteButton").patchValue(e),this.invoiceItems.at(n).get("disableEditButton").patchValue(e)}paymentTermChange(n){const e=Number(n.value),a=Z(this.form.get("invoiceDate").value).clone().add(e,"days");this.form.get("dueDate").patchValue(a.toDate())}changePaymentTerm(){if(!this.createMode$.getValue())return;const n=this.form.get("paymentTerm").value;if(!n)return;const e=Number(n),a=Z(this.form.get("invoiceDate").value).clone().add(e,"days");this.form.get("dueDate").patchValue(a.toDate())}optionsEvent(n){}disabled(){this.invoiceItems.controls.forEach((n,e)=>{n.disable()})}enabled(){this.invoiceItems.controls.forEach((n,e)=>{1===e&&n.enable()})}onItemValueChanges(n,e){e.get("amount").patchValue(e.get("unitPrice").value*e.get("quantity").value);let a=0,i=0,r=0,s=0,m=0,u=0;e.get("discountPercent").value&&e.get("discountPercent").value>0&&(a=e.get("discountPercent").value/100,i=e.get("amount").value*a,s=Math.round(100*i)/100),e.get("discountAmount").value&&e.get("discountAmount").value>0&&(r=e.get("discountAmount").value),m=s+r,e.get("totalDiscountAmount").patchValue(m),u=e.get("amount").value-m,e.get("netAmount").patchValue(u),this.onValueChanges()}onValueChanges(){let n=0,e=0,a=0,i=0,r=0,s=0,m=0,u=0,d=0,p=0,S=0;n=this.invoiceItems.controls.map(C=>C.value.netAmount).reduce((C,le)=>C+le,0),this.form.get("subTotal").patchValue(n),this.form.get("discountPercent").value&&this.form.get("discountPercent").value>0&&(e=this.form.get("discountPercent").value/100,i=n*e,r=Math.round(100*i)/100),this.form.get("discountAmount").value&&this.form.get("discountAmount").value>0&&(a=this.form.get("discountAmount").value),s=r+a,m=n-s,this.form.get("totalDiscountAmount").patchValue(s),this.form.get("amountAfterDiscount").patchValue(m),this.form.get("taxPercent").value&&this.form.get("taxPercent").value>0&&(u=this.form.get("taxPercent").value/100,d=m*u,p=Math.round(100*d)/100,this.form.get("taxAmount").patchValue(p)),S=m+p,this.form.get("totalAmount").patchValue(S)}summary(n){this.payAmount=n.entity.payedAmount,this.outStandingAmount=parseFloat(this.form.controls.totalAmount.value)-this.payAmount;let e=Z(new Date).diff(Z(this.form.controls.dueDate.value),"days");this.overDueDays=this.outStandingAmount>0&&e>0?e:0}optionSelected(n,e,a,i,r){const s=n.option.value?n.option.value:null;"object"==typeof s&&(this[e]=s,i.controls[a].patchValue(s[r]))}validateSelected(n,e,a,i,r){setTimeout(()=>{this[n]&&this[n][r]===i.controls[a].value?(i.controls[e].patchValue(this[n].id),"customer"===a&&(i.controls.paymentTerm.patchValue(this[n].paymentTerm),i.controls.billAddress.patchValue(this[n].billAddress),i.controls.billCity.patchValue(this[n].billCity),i.controls.billRegion.patchValue(this[n].billRegion),i.controls.billPostalCode.patchValue(this[n].billPostalCode),i.controls.billCountry.patchValue(this[n].billCountry),i.controls.billPhoneNumber.patchValue(this[n].billPhoneNumber),i.controls.shipAddress.patchValue(this[n].shipAddress),i.controls.shipCity.patchValue(this[n].shipCity),i.controls.shipRegion.patchValue(this[n].shipRegion),i.controls.shipPostalCode.patchValue(this[n].shipPostalCode),i.controls.shipCountry.patchValue(this[n].shipCountry),i.controls.shipPhoneNumber.patchValue(this[n].shipPhoneNumber),i.controls.currencyId.patchValue(this[n].currencyId),i.controls.currency.patchValue(this[n].currency),this.changePaymentTerm())):(i.controls[a].patchValue(""),i.controls[e].patchValue(""),"customer"===a&&(i.controls.paymentTerm.patchValue(30),i.controls.billAddress.patchValue(""),i.controls.billCity.patchValue(""),i.controls.billRegion.patchValue(""),i.controls.billPostalCode.patchValue(""),i.controls.billCountry.patchValue(""),i.controls.billPhoneNumber.patchValue(""),i.controls.shipAddress.patchValue(0),i.controls.shipCity.patchValue(""),i.controls.shipRegion.patchValue(""),i.controls.shipPostalCode.patchValue(""),i.controls.shipCountry.patchValue(""),i.controls.shipPhoneNumber.patchValue(""),i.controls.currencyId.patchValue(""),i.controls.currency.patchValue(""),this.changePaymentTerm()),this[n]="")},300)}download(n){if(this.createMode$.getValue()||0===this.id.length||this.id===f.i.empty)return;let e=new Array;e.push(this.id),this.httpService.HttpPost(this.sessionService.urlSetting.invoiceManagementWebApiUrl+"invoice/downloadInvoice",JSON.stringify({renderType:n,guids:e,format:"invoice"})).subscribe(r=>{this.downloadSuccess(r.entity)},r=>this.downloadFailed(r))}downloadSuccess(n){this.fileService.convertToBlob(n.base64,n.fileName,O.T[O.T.base64]).then(e=>{this.fileService.downloadFile(e,n.fileName)})}downloadFailed(n){}clearInput(n,e,a){n.stopPropagation(),this.form.get(e).patchValue(""),a.openPanel()}openOrClosePanel(n,e,a){n.stopPropagation(),e.panelOpen?e.closePanel():(this.obs(a),e.openPanel())}initReferences(){this.customerAutoComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"customer",this.sessionService.urlSetting.invoiceManagementWebApiUrl+"customer/GetCustomers","description","customerObs"),this.currencyAutoComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"currency",this.sessionService.urlSetting.invoiceManagementWebApiUrl+"references/GetCurrecies","description","currencyObs"),this.paymentMethodComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"paymentMethod",this.sessionService.urlSetting.invoiceManagementWebApiUrl+"paymentMethod/GetPaymentMethods","description","paymentMethodObs")}patchAutoComplete(n){if(null===n)return this.selectedCurrency=null,this.selectedCustomer=null,void(this.selectedPaymentMethod=null);this.selectedCustomer={id:n.customerId,description:n.customer},this.selectedPaymentMethod={id:n.paymentMethodId,description:n.paymentMethod},this.selectedCurrency={id:n.currencyId,description:n.currency}}obs(n){(new L.U).sortExpression="description",this[n]||"paymentMethodObs"!==n?this[n]||"currencyObs"!==n?!this[n]&&"customerObs"===n&&(this.customerAutoComplete$=this.lookupService.autoCompleteObs(this.form,"customer",this.sessionService.urlSetting.invoiceManagementWebApiUrl+"customer/GetCustomers","description","customerObs")):this.currencyAutoComplete$=this.lookupService.autoCompleteObs(this.form,"currency",this.sessionService.urlSetting.invoiceManagementWebApiUrl+"references/GetCurrecies","description","currencyObs"):this.paymentMethodComplete$=this.lookupService.autoCompleteObs(this.form,"paymentMethod",this.sessionService.urlSetting.invoiceManagementWebApiUrl+"paymentMethod/GetPaymentMethods","description","paymentMethodObs"),this[n]=!0}};v.\u0275fac=function(n){return new(n||v)(t.Y36(c.qu),t.Y36(_.OE),t.Y36(_.mj),t.Y36(x.F0),t.Y36(x.gz),t.Y36(_._W),t.Y36(_.cw),t.Y36(_.WO),t.Y36(J.uw),t.Y36(_.xd),t.Y36(st.L),t.Y36(_.Ip))},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-invoice-maintenance"]],decls:260,vars:79,consts:[["fxLayout","column","fxLayoutAlign","space-around stretch"],[3,"formGroup"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutGap","16px grid",1,"matero-mat-form-field"],[3,"fxFlex","fxFlex.md","fxFlex.sm"],["fxLayout","row wrap","fxLayoutGap","16px 0px grid"],["fxFlex","50","fxFlex.lt-md","100",3,"ngClass"],["formControlName","customer","matInput","",3,"matAutocomplete","blur"],["customerTrigger","matAutocompleteTrigger"],["matSuffix","",2,"display","flex"],["mat-icon-button","","type","button",3,"click",4,"ngIf"],["mat-icon-button","","type","button",3,"click"],[3,"closed","opened","optionSelected"],["customerId","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex","50","fxFlex.lt-md","100"],["matInput","","formControlName","invoiceNumber","oninput","this.value = this.value.toUpperCase()"],["fxFlex","30","fxFlex.lt-md","100",1,"min-w-150","max-w-300"],["matInput","","formControlName","invoiceDate","appDatemask","",3,"matDatepicker"],["matSuffix","",3,"for"],["invoiceDate",""],["matInput","","formControlName","dueDate","appDatemask","",3,"matDatepicker"],["dueDate",""],["fxFlex","40","fxFlex.lt-md","100",2,"font-size","14px"],[1,"m-t-16"],["formControlName","paymentTerm",2,"margin-left","10px",3,"change"],[2,"margin-right","10px",3,"value","checked"],["formControlName","currency","matInput","",3,"matAutocomplete","blur"],["currencyTrigger","matAutocompleteTrigger"],["currencyId","matAutocomplete"],["formControlName","paymentMethod","matInput","",3,"matAutocomplete","blur"],["paymentMethodTrigger","matAutocompleteTrigger"],["paymentMethodId","matAutocomplete"],["fxLayout","row wrap","fxLayoutGap","5px 0px grid"],["fxLayout","row wrap",2,"border","1px solid #e0e0e0","padding","8px","border-radius","3%"],["fxFlex","100","fxFlex.lt-md","100"],["matInput","","formControlName","billAddress","rows","2"],["matInput","","formControlName","billCountry"],["fxLayout","row wrap","fxLayoutGap","5px 0px grid",2,"width","100%"],["fxFlex","40","fxFlex.lg","40","fxFlex.md","100","fxFlex.sm","100","fxFlex.xs","100"],["matInput","","formControlName","billCity"],["fxFlex","60","fxFlex.lg","60","fxFlex.md","100","fxFlex.sm","100","fxFlex.xs","100"],["matInput","","formControlName","billRegion"],["matInput","","formControlName","billPostalCode"],["matInput","","formControlName","billPhoneNumber"],["matInput","","formControlName","shipAddress","rows","2"],["matInput","","formControlName","shipCountry"],["matInput","","formControlName","shipCity"],["matInput","","formControlName","shipRegion"],["matInput","","formControlName","shipPostalCode"],["matInput","","formControlName","shipPhoneNumber"],["fxFlex","15","fxFlex.md","20","fxFlex.sm","20",2,"background-color","#e4e4e4",3,"fxHide"],["fxLayout","column","fxLayoutGap","8px",2,"padding-top","8px"],[3,"ngClass"],["matLine","","fxLayout","row","fxLayoutAlign","space-between center"],[1,"f-s-12","f-w-100"],[1,"f-s-16","f-w-600",2,"margin-left","2px"],[1,"matero-group-button"],["fxLayout","row","fxLayoutAlign","start center"],["mat-icon-button","",3,"click"],["matTooltip","add item"],["fxFlex","12px"],["mat-icon-button",""],["aria-label","label"],["formArrayName","invoiceItems","appMaterialElevation","","raisedElevation","16",1,"matero-table-container","mat-form-field-with-label",3,"defaultElevation"],["mat-table","","multiTemplateDataRows","true",3,"dataSource"],["matColumnDef","lineItemNumber"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","style","width:5%","class","rowspan-right",3,"formGroup","ngClass",4,"matCellDef"],["matColumnDef","name"],["mat-cell","","style","width:50%",3,"formGroup",4,"matCellDef"],["matColumnDef","unitPrice"],["mat-cell","","style","width:15%",3,"formGroup",4,"matCellDef"],["matColumnDef","quantity"],["matColumnDef","amount"],["matColumnDef","actions"],["mat-cell","","data-label","Actions","class","rowspan-left","style","width:10%",3,"formGroup",4,"matCellDef"],["matColumnDef","remark"],["mat-cell","",3,"formGroup",4,"matCellDef"],["matColumnDef","discountPercent"],["mat-cell","","class","min-w-80 max-w-100",3,"formGroup",4,"matCellDef"],["matColumnDef","discountAmount"],["matColumnDef","totalDiscountAmount"],["matColumnDef","netAmount"],["mat-row","",3,"ngClass","mouseenter","mouseleave",4,"matRowDef","matRowDefColumns"],["fxLayout","row wrap"],["fxFlex","70","fxFlex.md","55","fxFlex.sm","40","fxFlex.xs","100"],["fxFlex","30","fxFlex.md","45","fxFlex.sm","60","fxFlex.xs","100",1,"sub-total"],["fxLayout","row","fxLayoutAlign","space-between center"],["appearance","outline",1,"max-w-200",2,"white-space","nowrap"],["matInput","","formControlName","subTotal","type","text","mask","separator.2","thousandSeparator",","],["appearance","outline",1,"max-w-200"],["matInput","","formControlName","discountPercent","type","text","mask","999",3,"keyup"],["matInput","","formControlName","discountAmount","type","text","mask","separator.2","thousandSeparator",",",3,"keyup"],["appearance","outline",1,"max-w-200",3,"ngStyle"],["matInput","","formControlName","totalDiscountAmount","type","text","mask","separator.2","thousandSeparator",","],["matInput","","formControlName","amountAfterDiscount","type","text","mask","separator.2","thousandSeparator",",",3,"allowNegativeNumbers"],["appearance","outline",2,"width","70px","margin-left","5px"],["matInput","","formControlName","taxPercent","mask","000"],["matInput","","formControlName","taxAmount","type","text","mask","separator.2","thousandSeparator",",",3,"allowNegativeNumbers"],["matInput","","formControlName","totalAmount","type","text","mask","separator.2","thousandSeparator",",",3,"allowNegativeNumbers"],[3,"value"],[4,"ngFor","ngForOf"],["mat-header-cell",""],["mat-cell","",1,"rowspan-right",2,"width","5%",3,"formGroup","ngClass"],[1,"f-w-600","p-r-8"],["mat-cell","",2,"width","50%",3,"formGroup"],[1,"p-l-16","min-w-400"],["tabindex","1","matInput","","formControlName","name"],["mat-cell","",2,"width","15%",3,"formGroup"],[1,"max-w-200"],["tabindex","2","matInput","","formControlName","unitPrice","type","text","mask","separator.2","thousandSeparator",",",3,"keyup"],["matPrefix",""],["tabindex","3","matInput","","formControlName","quantity","type","text","mask","0000",3,"keyup"],["tabindex","4","matInput","","formControlName","amount","readonly","","type","text","mask","separator.2","thousandSeparator",","],["mat-cell","","data-label","Actions",1,"rowspan-left",2,"width","10%",3,"formGroup"],["mat-icon-button","",3,"matMenuTriggerFor","disabled"],["menu","matMenu"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["mat-menu-item","",3,"disabled","click"],["mat-cell","",3,"formGroup"],[1,"m-l--8",2,"width","100%"],["tabindex","5","matInput","","formControlName","remark"],["mat-cell","",1,"min-w-80","max-w-100",3,"formGroup"],[1,"min-w-80","max-w-150",3,"ngStyle"],["tabindex","6","matInput","","formControlName","discountPercent","type","text","mask","000",3,"keyup"],["matSuffix",""],[1,"min-w-100","max-w-150",3,"ngStyle"],["tabindex","7","matInput","","formControlName","discountAmount","type","text","mask","separator.2","thousandSeparator",",",3,"keyup"],[1,"max-w-200",3,"ngStyle"],["matInput","","formControlName","totalDiscountAmount","type","text","mask","separator.2","thousandSeparator",",","readonly",""],["matInput","","formControlName","netAmount","type","text","readonly","","mask","separator.2","thousandSeparator",",",3,"allowNegativeNumbers"],["mat-row","",3,"ngClass","mouseenter","mouseleave"]],template:function(n,e){if(1&n){const a=t.EpF();t.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),t._uU(7,"Customer"),t.qZA(),t.TgZ(8,"input",6,7),t.NdJ("blur",function(){return e.validateSelected("selectedCustomer","customerId","customer",e.form,"description")}),t.qZA(),t.TgZ(10,"div",8),t.YNc(11,ft,3,0,"button",9),t.TgZ(12,"button",10),t.NdJ("click",function(r){t.CHM(a);const s=t.MAs(9);return e.openOrClosePanel(r,s,"customerObs")}),t.TgZ(13,"mat-icon"),t._uU(14),t.qZA()()(),t.TgZ(15,"mat-autocomplete",11,12),t.NdJ("closed",function(){return e.customerArrow="arrow_drop_down"})("opened",function(){return e.customerArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedCustomer","customer",e.form,"description")}),t.YNc(17,vt,3,4,"mat-option",13),t.ALo(18,"async"),t.qZA(),t.YNc(19,_t,3,4,"mat-error",14),t.qZA(),t.TgZ(20,"mat-form-field",15)(21,"mat-label"),t._uU(22,"Invoice Number"),t.qZA(),t._UZ(23,"input",16),t.YNc(24,bt,3,4,"mat-error",14),t.qZA(),t.TgZ(25,"mat-form-field",17)(26,"mat-label"),t._uU(27,"Invoice Date"),t.qZA(),t._UZ(28,"input",18)(29,"mat-datepicker-toggle",19)(30,"mat-datepicker",null,20),t.YNc(32,At,3,4,"mat-error",14),t.qZA(),t.TgZ(33,"mat-form-field",17)(34,"mat-label"),t._uU(35,"Payment Due Date"),t.qZA(),t._UZ(36,"input",21)(37,"mat-datepicker-toggle",19)(38,"mat-datepicker",null,22),t.YNc(40,Ct,3,4,"mat-error",14),t.qZA(),t.TgZ(41,"div",23)(42,"div",24)(43,"mat-label"),t._uU(44,"Payment Term (days)"),t.qZA(),t.TgZ(45,"mat-radio-group",25),t.NdJ("change",function(r){return e.paymentTermChange(r)}),t.TgZ(46,"mat-radio-button",26),t._uU(47,"30"),t.qZA(),t.TgZ(48,"mat-radio-button",26),t._uU(49,"60"),t.qZA(),t.TgZ(50,"mat-radio-button",26),t._uU(51,"90"),t.qZA(),t.TgZ(52,"mat-radio-button",26),t._uU(53,"120"),t.qZA()()()(),t.TgZ(54,"mat-form-field",15)(55,"mat-label"),t._uU(56,"Currency"),t.qZA(),t.TgZ(57,"input",27,28),t.NdJ("blur",function(){return e.validateSelected("selectedCurrency","currencyId","currency",e.form,"description")}),t.qZA(),t.TgZ(59,"div",8),t.YNc(60,Zt,3,0,"button",9),t.TgZ(61,"button",10),t.NdJ("click",function(r){t.CHM(a);const s=t.MAs(58);return e.openOrClosePanel(r,s,"currencyObs")}),t.TgZ(62,"mat-icon"),t._uU(63),t.qZA()()(),t.TgZ(64,"mat-autocomplete",11,29),t.NdJ("closed",function(){return e.currencyArrow="arrow_drop_down"})("opened",function(){return e.currencyArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedCurrency","currency",e.form,"description")}),t.YNc(66,Tt,3,4,"mat-option",13),t.ALo(67,"async"),t.qZA(),t.YNc(68,St,3,4,"mat-error",14),t.qZA(),t.TgZ(69,"mat-form-field",15)(70,"mat-label"),t._uU(71,"Payment Method"),t.qZA(),t.TgZ(72,"input",30,31),t.NdJ("blur",function(){return e.validateSelected("selectedPaymentMethod","paymentMethodId","paymentMethod",e.form,"description")}),t.qZA(),t.TgZ(74,"div",8),t.YNc(75,Nt,3,0,"button",9),t.TgZ(76,"button",10),t.NdJ("click",function(r){t.CHM(a);const s=t.MAs(73);return e.openOrClosePanel(r,s,"paymentMethodObs")}),t.TgZ(77,"mat-icon"),t._uU(78),t.qZA()()(),t.TgZ(79,"mat-autocomplete",11,32),t.NdJ("closed",function(){return e.paymentMethodArrow="arrow_drop_down"})("opened",function(){return e.paymentMethodArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedPaymentMethod","paymentMethod",e.form,"description")}),t.YNc(81,wt,3,4,"mat-option",13),t.ALo(82,"async"),t.qZA(),t.YNc(83,Dt,3,4,"mat-error",14),t.qZA(),t.TgZ(84,"div",33)(85,"div",15)(86,"div",34)(87,"div"),t._uU(88," Billing Address"),t.qZA(),t.TgZ(89,"mat-form-field",35)(90,"mat-label"),t._uU(91,"Address"),t.qZA(),t._UZ(92,"textarea",36),t.qZA(),t.TgZ(93,"mat-form-field",35)(94,"mat-label"),t._uU(95,"Country"),t.qZA(),t._UZ(96,"input",37),t.qZA(),t.TgZ(97,"div",38)(98,"mat-form-field",39)(99,"mat-label"),t._uU(100,"City"),t.qZA(),t._UZ(101,"input",40),t.qZA(),t.TgZ(102,"mat-form-field",41)(103,"mat-label"),t._uU(104,"Region"),t.qZA(),t._UZ(105,"input",42),t.qZA()(),t.TgZ(106,"div",38)(107,"mat-form-field",39)(108,"mat-label"),t._uU(109,"PostalCode"),t.qZA(),t._UZ(110,"input",43),t.qZA(),t.TgZ(111,"mat-form-field",41)(112,"mat-label"),t._uU(113,"Tel."),t.qZA(),t._UZ(114,"input",44),t.qZA()()()(),t.TgZ(115,"div",15)(116,"div",34)(117,"div"),t._uU(118," Shipping Address"),t.qZA(),t.TgZ(119,"mat-form-field",35)(120,"mat-label"),t._uU(121,"Address"),t.qZA(),t._UZ(122,"textarea",45),t.qZA(),t.TgZ(123,"mat-form-field",35)(124,"mat-label"),t._uU(125,"Country"),t.qZA(),t._UZ(126,"input",46),t.qZA(),t.TgZ(127,"div",38)(128,"mat-form-field",39)(129,"mat-label"),t._uU(130,"City"),t.qZA(),t._UZ(131,"input",47),t.qZA(),t.TgZ(132,"mat-form-field",41)(133,"mat-label"),t._uU(134,"Region"),t.qZA(),t._UZ(135,"input",48),t.qZA()(),t.TgZ(136,"div",38)(137,"mat-form-field",39)(138,"mat-label"),t._uU(139,"PostalCode"),t.qZA(),t._UZ(140,"input",49),t.qZA(),t.TgZ(141,"mat-form-field",41)(142,"mat-label"),t._uU(143,"Tel."),t.qZA(),t._UZ(144,"input",50),t.qZA()()()()()()(),t.TgZ(145,"div",51)(146,"div",52)(147,"mat-card",53)(148,"mat-card-content")(149,"p",54)(150,"span",55),t._uU(151,"Pay Amount "),t.qZA(),t.TgZ(152,"span",56),t._uU(153),t.ALo(154,"currency"),t.qZA()()()(),t.TgZ(155,"mat-card",53)(156,"mat-card-content")(157,"p",54)(158,"span",55),t._uU(159,"Outstanding Amount "),t.qZA(),t.TgZ(160,"span",56),t._uU(161),t.ALo(162,"currency"),t.qZA()()()(),t.TgZ(163,"mat-card",53)(164,"mat-card-content")(165,"p",54)(166,"span",55),t._uU(167,"Over Due Days"),t.qZA(),t.TgZ(168,"span",56),t._uU(169),t.qZA()()()()()()()(),t.TgZ(170,"div",57)(171,"div",58)(172,"button",59),t.NdJ("click",function(){return e.insertLineItem()}),t.TgZ(173,"mat-icon",60),t._uU(174,"add"),t.qZA()(),t._UZ(175,"span",61),t.TgZ(176,"button",62)(177,"mat-icon",63),t._uU(178,"print"),t.qZA()()()(),t.TgZ(179,"form",1)(180,"div",64)(181,"table",65),t.ynx(182,66),t.YNc(183,kt,1,0,"th",67),t.YNc(184,qt,3,6,"td",68),t.BQk(),t.ynx(185,69),t.YNc(186,Jt,1,0,"th",67),t.YNc(187,Qt,5,2,"td",70),t.BQk(),t.ynx(188,71),t.YNc(189,Lt,1,0,"th",67),t.YNc(190,Ft,7,1,"td",72),t.BQk(),t.ynx(191,73),t.YNc(192,Vt,2,0,"th",67),t.YNc(193,$t,5,1,"td",72),t.BQk(),t.ynx(194,74),t.YNc(195,Et,2,0,"th",67),t.YNc(196,Ot,7,1,"td",72),t.BQk(),t.ynx(197,75),t.YNc(198,Yt,2,0,"th",67),t.YNc(199,Ht,14,8,"td",76),t.BQk(),t.ynx(200,77),t.YNc(201,jt,5,1,"td",78),t.BQk(),t.ynx(202,79),t.YNc(203,Wt,7,3,"td",80),t.BQk(),t.ynx(204,81),t.YNc(205,zt,7,3,"td",78),t.BQk(),t.ynx(206,82),t.YNc(207,Kt,7,3,"td",78),t.BQk(),t.ynx(208,83),t.YNc(209,Xt,7,4,"td",78),t.BQk(),t.YNc(210,te,1,3,"tr",84),t.YNc(211,ee,1,3,"tr",84),t.qZA()()(),t.TgZ(212,"form",1)(213,"div",85),t._UZ(214,"div",86),t.TgZ(215,"div",87)(216,"div",88)(217,"span"),t._uU(218,"Sub Total"),t.qZA(),t.TgZ(219,"span")(220,"mat-form-field",89),t._UZ(221,"input",90),t.qZA()()(),t.TgZ(222,"div",88)(223,"span"),t._uU(224,"Discount(%)"),t.qZA(),t.TgZ(225,"span")(226,"mat-form-field",91)(227,"input",92),t.NdJ("keyup",function(){return e.onValueChanges()}),t.qZA()()()(),t.TgZ(228,"div",88)(229,"span"),t._uU(230,"Discount ($)"),t.qZA(),t.TgZ(231,"span")(232,"mat-form-field",91)(233,"input",93),t.NdJ("keyup",function(){return e.onValueChanges()}),t.qZA()()()(),t.TgZ(234,"div",88)(235,"span"),t._uU(236,"Total Discount Amount"),t.qZA(),t.TgZ(237,"span")(238,"mat-form-field",94),t._UZ(239,"input",95),t.qZA()()(),t.TgZ(240,"div",88)(241,"span"),t._uU(242,"Total Amount After Discount"),t.qZA(),t.TgZ(243,"span")(244,"mat-form-field",91),t._UZ(245,"input",96),t.qZA()()(),t.TgZ(246,"div",88)(247,"span",58),t._uU(248,"Tax(%) "),t.TgZ(249,"mat-form-field",97),t._UZ(250,"input",98),t.qZA()(),t.TgZ(251,"span")(252,"mat-form-field",94),t._UZ(253,"input",99),t.qZA()()(),t.TgZ(254,"div",88)(255,"span"),t._uU(256,"Total Amount"),t.qZA(),t.TgZ(257,"span")(258,"mat-form-field",94),t._UZ(259,"input",100),t.qZA()()()()()()()}if(2&n){const a=t.MAs(16),i=t.MAs(31),r=t.MAs(39),s=t.MAs(65),m=t.MAs(80);let u,d,p;t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("fxFlex",e.createMode$.getValue()?100:85)("fxFlex.md",e.createMode$.getValue()?100:80)("fxFlex.sm",e.createMode$.getValue()?100:80),t.xp6(2),t.ekj("disabled",e.payAmount>0),t.Q6J("ngClass",t.VKq(66,ne,e.payAmount>0)),t.xp6(3),t.Q6J("matAutocomplete",a),t.xp6(3),t.Q6J("ngIf",null!==(null==(u=e.form.get("customer"))?null:u.value)&&""!==(null==(u=e.form.get("customer"))?null:u.value)),t.xp6(3),t.Oqu(e.customerArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(18,56,e.customerAutoComplete$)),t.xp6(2),t.Q6J("ngIf",e.form.get("customer").invalid&&(e.form.get("customer").dirty||e.form.get("customer").touched)),t.xp6(5),t.Q6J("ngIf",e.form.get("invoiceNumber").invalid&&(e.form.get("invoiceNumber").dirty||e.form.get("invoiceNumber").touched)),t.xp6(4),t.Q6J("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(3),t.Q6J("ngIf",e.form.get("invoiceDate").invalid&&(e.form.get("invoiceDate").dirty||e.form.get("invoiceDate").touched)),t.xp6(4),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(3),t.Q6J("ngIf",e.form.get("dueDate").invalid&&(e.form.get("dueDate").dirty||e.form.get("dueDate").touched)),t.xp6(6),t.Q6J("value",30)("checked",30===e.form.get("paymentTerm").value),t.xp6(2),t.Q6J("value",60)("checked",60===e.form.get("paymentTerm").value),t.xp6(2),t.Q6J("value",90)("checked",90===e.form.get("paymentTerm").value),t.xp6(2),t.Q6J("value",120)("checked",120===e.form.get("paymentTerm").value),t.xp6(5),t.Q6J("matAutocomplete",s),t.xp6(3),t.Q6J("ngIf",null!==(null==(d=e.form.get("currency"))?null:d.value)&&""!==(null==(d=e.form.get("currency"))?null:d.value)),t.xp6(3),t.Oqu(e.currencyArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(67,58,e.currencyAutoComplete$)),t.xp6(2),t.Q6J("ngIf",e.form.get("currency").invalid&&(e.form.get("currency").dirty||e.form.get("currency").touched)),t.xp6(4),t.Q6J("matAutocomplete",m),t.xp6(3),t.Q6J("ngIf",null!==(null==(p=e.form.get("paymentMethod"))?null:p.value)&&""!==(null==(p=e.form.get("paymentMethod"))?null:p.value)),t.xp6(3),t.Oqu(e.paymentMethodArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(82,60,e.paymentMethodComplete$)),t.xp6(2),t.Q6J("ngIf",e.form.get("paymentMethod").invalid&&(e.form.get("paymentMethod").dirty||e.form.get("paymentMethod").touched)),t.xp6(62),t.Q6J("fxHide",e.createMode$.getValue()),t.xp6(2),t.Q6J("ngClass",t.VKq(68,M,e.color[0])),t.xp6(6),t.hij("",t.lcZ(154,62,e.payAmount)," "),t.xp6(2),t.Q6J("ngClass",t.VKq(70,M,e.color[1])),t.xp6(6),t.hij("",t.lcZ(162,64,e.form.get("totalAmount").value-e.payAmount)," "),t.xp6(2),t.Q6J("ngClass",0===e.overDueDays?t.VKq(72,M,e.color[2]):t.VKq(74,M,e.color[3])),t.xp6(6),t.hij("",e.overDueDays," "),t.xp6(10),t.Q6J("formGroup",e.formArray),t.xp6(1),t.Q6J("defaultElevation",2),t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(29),t.Q6J("matRowDefColumns",e.firstLineColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.secondLineColumns),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(26),t.Q6J("ngStyle",e.form.get("totalDiscountAmount").invalid&&t.DdM(76,b)),t.xp6(7),t.Q6J("allowNegativeNumbers",!0),t.xp6(7),t.Q6J("ngStyle",e.form.get("taxAmount").invalid&&t.DdM(77,b)),t.xp6(1),t.Q6J("allowNegativeNumbers",!0),t.xp6(5),t.Q6J("ngStyle",e.form.get("totalAmount").invalid&&t.DdM(78,b)),t.xp6(1),t.Q6J("allowNegativeNumbers",!0)}},directives:[T.xw,T.Wh,c._Y,c.JL,c.sg,T.SQ,T.yH,I.KE,g.mk,w.oO,I.hX,c.Fj,lt.Nt,Y.ZL,c.JJ,c.u,I.R9,g.O5,ct.lW,mt.Hw,Y.XC,g.sg,R.ey,I.TO,U.hl,ut.v,U.nW,U.Mq,G.VQ,G.U0,w.b8,B.a8,B.dn,R.X2,pt.gM,c.CE,dt.F,h.BZ,h.w1,h.fO,h.ge,h.Dz,h.ev,H.hx,I.qo,D.p6,D.VK,D.OP,g.PC,w.Zl,h.nj,h.Gk],pipes:[g.Ov,g.rS,ht.h,g.H9],styles:[".rowspan-left[_ngcontent-%COMP%]{border-left:1px solid #CCCCCC}.rowspan-right[_ngcontent-%COMP%]{border-right:1px solid #CCCCCC}  .sub-total{font-size:14px}  .sub-total .mat-form-field{font-size:13px;max-height:40px;max-width:200px}  .sub-total .mat-form-field input{margin-top:-30px}  .sub-total .mat-form-field .mat-form-field-flex{padding-top:8px;max-height:40px}  .sub-total .mat-form-field .mat-form-field-wrapper{padding-bottom:12px}  .sub-total .mat-form-field .mat-form-field-underline{bottom:14px}  .sub-total .mat-form-field .mat-form-field-infix{top:-1.25em}  .sub-total .mat-form-field .mat-form-field-infix .mat-input-element:disabled{color:gray!important}  .sub-total .mat-form-field .mat-form-field-appearance-outline .mat-form-field-prefix,   .sub-total .mat-form-field .mat-form-field-appearance-outline .mat-form-field-suffix{top:-1.25em!important}  .sub-total .mat-form-field .mat-form-field-appearance-outline .mat-form-field-label{margin-top:0}  .sub-total .mat-form-field .mat-form-field-appearance-outline.mat-form-field-disabled.mat-form-field-label{color:red}  .sub-total .mat-form-field .mat-form-field-appearance-outline.mat-form-field-disabled{color:red}"]}),v=(0,P.gn)([(0,A.c)()],v);const oe=[{path:"maintenance",component:y,children:[{path:"",component:v,data:{title:"Invoice Maintenance"}},{path:"maintenance/:id",component:v}]}];let ie=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[x.Bz.forChild(oe)],x.Bz]}),o})();var ae=l(9112);const re=[ie,W.m,z.O,ae.I$,H.yI.forRoot(E.ik)];let se=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.ez,...re]]}),o})()}}]);