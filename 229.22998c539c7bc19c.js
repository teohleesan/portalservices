"use strict";(self.webpackChunkPortal=self.webpackChunkPortal||[]).push([[229],{2229:(ye,H,s)=>{s.r(H),s.d(H,{PersonalModule:()=>ve});var $=s(5518),f=s(9808),K=s(224),tt=s(4253),g=s(9826),P=s(655),C=s(4576),q=s(5101),F=s(9256),c=s(4987),et=s(449),d=s(4999),j=s(8966),it=s(13),u=s(2062);class z{constructor(){this.id=u.i.empty,this.personalId=u.i.empty,this.fileName="",this.remark="",this.isImage=!1,this.isChecked=!1,this.base64String=null,this.img=null,this.file=null}}var ot=s(4241),w=s(3606),t=s(5e3),p=s(3038),nt=s(7809),at=s(8639),J=s(8446),v=s(7093),E=s(7423),rt=s(3322),Q=s(5245),S=s(3954),Y=s(508),st=s(7446),W=s(2046),T=s(3489),B=s(8833),m=s(3075);const lt=["fileUpload"];function ct(o,i){if(1&o&&t._UZ(0,"img",19),2&o){const e=t.oxw().$implicit;t.Q6J("src",e.img,t.LSH)}}function mt(o,i){if(1&o&&t._UZ(0,"img",20),2&o){const e=t.oxw().$implicit;t.Q6J("src",e.img,t.LSH)}}function ut(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"mat-grid-tile",11)(1,"mat-grid-tile-header")(2,"span",12),t._uU(3),t.qZA(),t._UZ(4,"span",13),t.TgZ(5,"span")(6,"mat-checkbox",14),t.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){const l=t.CHM(e).$implicit,_=t.oxw(2);return n?_.selection.toggle(l):null}),t.qZA()()(),t.YNc(7,ct,1,1,"img",15),t.YNc(8,mt,1,1,"img",16),t.TgZ(9,"mat-grid-tile-footer")(10,"span",17),t._uU(11),t.qZA(),t._UZ(12,"span",13),t.TgZ(13,"span")(14,"button",18),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).download(r)}),t.TgZ(15,"mat-icon"),t._uU(16,"cloud_download"),t.qZA()()()()()}if(2&o){const e=i.$implicit,a=i.index,n=t.oxw(2);t.xp6(3),t.hij("Document: ",a+1,""),t.xp6(3),t.Q6J("checked",n.selection.isSelected(e)),t.xp6(1),t.Q6J("ngIf",e.isImage),t.xp6(1),t.Q6J("ngIf",!e.isImage),t.xp6(3),t.Oqu(e.remark)}}const pt=function(o){return{disabled:o}};function dt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div")(1,"div",2)(2,"div",3)(3,"div",4)(4,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().onUpload()}),t.TgZ(5,"mat-icon",6),t._uU(6,"cloud_upload"),t.qZA()()(),t.TgZ(7,"div",4)(8,"button",7),t.NdJ("click",function(n){return t.CHM(e),t.oxw().deleteMutiple(n)}),t.TgZ(9,"mat-icon",6),t._uU(10,"delete"),t.qZA()()()()(),t.TgZ(11,"mat-grid-list",8),t.YNc(12,ut,17,5,"mat-grid-tile",9),t.qZA(),t._UZ(13,"app-empty-layout",10),t.qZA()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngClass",t.VKq(8,pt,!e.id||""===e.id||e.id===e.emptyGuid)),t.xp6(4),t.Q6J("disabled",e.selection.selected.length<=0),t.xp6(1),t.ekj("disabled",e.selection.selected.length<=0),t.xp6(3),t.Q6J("ngForOf",e.dataSource.data),t.xp6(1),t.Q6J("lastRowIndex",e.lastRowIndex)("title","Oops!")("message","No record found")}}function ft(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",32),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onUploadFile()}),t._uU(1,"Upload"),t.qZA()}}function ht(o,i){1&o&&t._UZ(0,"th",45)}function gt(o,i){if(1&o&&(t.TgZ(0,"td",46)(1,"div"),t._uU(2),t.qZA()()),2&o){const e=i.index;t.xp6(2),t.hij(" ",e+1," ")}}function _t(o,i){1&o&&t._UZ(0,"th",45)}function vt(o,i){1&o&&(t.TgZ(0,"td",46)(1,"div")(2,"mat-icon",47),t._uU(3,"attach_file"),t.qZA()()())}function yt(o,i){1&o&&(t.TgZ(0,"th",48),t._uU(1,"Remark"),t.qZA())}function bt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",46)(1,"div",49)(2,"mat-form-field")(3,"input",50),t.NdJ("ngModelChange",function(n){return t.CHM(e).$implicit.remark=n}),t.qZA()()()()}if(2&o){const e=i.$implicit;t.xp6(3),t.Q6J("ngModel",e.remark)}}function xt(o,i){1&o&&(t.TgZ(0,"th",45),t._uU(1,"File Name"),t.qZA())}function Zt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",46)(1,"div",49)(2,"mat-form-field")(3,"input",51),t.NdJ("ngModelChange",function(n){return t.CHM(e).$implicit.fileName=n}),t.qZA()()()()}if(2&o){const e=i.$implicit;t.xp6(3),t.Q6J("ngModel",e.fileName)}}function Ct(o,i){1&o&&(t.TgZ(0,"th",45),t._uU(1,"Remove"),t.qZA())}function St(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",46)(1,"button",18),t.NdJ("click",function(){const r=t.CHM(e).index;return t.oxw(3).delete(r)}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()()}}function Tt(o,i){1&o&&t._UZ(0,"tr",52)}function At(o,i){1&o&&t._UZ(0,"tr",53)}function Pt(o,i){if(1&o&&(t.TgZ(0,"div",33)(1,"table",34),t.ynx(2,35),t.YNc(3,ht,1,0,"th",36),t.YNc(4,gt,3,1,"td",37),t.BQk(),t.ynx(5,38),t.YNc(6,_t,1,0,"th",36),t.YNc(7,vt,4,0,"td",37),t.BQk(),t.ynx(8,39),t.YNc(9,yt,2,0,"th",40),t.YNc(10,bt,4,1,"td",37),t.BQk(),t.ynx(11,41),t.YNc(12,xt,2,0,"th",36),t.YNc(13,Zt,4,1,"td",37),t.BQk(),t.ynx(14,42),t.YNc(15,Ct,2,0,"th",36),t.YNc(16,St,4,0,"td",37),t.BQk(),t.YNc(17,Tt,1,0,"tr",43),t.YNc(18,At,1,0,"tr",44),t.qZA()()),2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("dataSource",e.dataSourceUpload),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}function wt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",21)(2,"div",4)(3,"button",18),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return n.isUpload=!n.isUpload}),t.TgZ(4,"mat-icon",6),t._uU(5,"arrow_back"),t.qZA()(),t.TgZ(6,"button",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().clear()}),t.TgZ(7,"mat-icon",6),t._uU(8,"clear"),t.qZA()()()()(),t.TgZ(9,"div",22)(10,"div",23)(11,"a")(12,"img",24),t.NdJ("click",function(){return t.CHM(e),t.oxw().onFileChange()}),t.qZA()(),t._UZ(13,"input",25,26),t.TgZ(15,"label",27),t._uU(16,"Choose multiple images"),t.qZA(),t.TgZ(17,"h3"),t._uU(18,"select your PNG/JPG/JPEG/GIF or PDF/EXCEL/WORD/TEXT files here"),t.qZA(),t.TgZ(19,"span",28),t._uU(20,"Maximum file size for upload is 100 kb"),t.qZA(),t.TgZ(21,"span",28),t._uU(22,"Each time limit for 5 files"),t.qZA(),t.TgZ(23,"div",29),t.YNc(24,ft,2,0,"button",30),t.qZA()(),t.YNc(25,Pt,19,3,"div",31),t.qZA()}if(2&o){const e=t.oxw();t.xp6(13),t.Q6J("accept",e.acceptFile),t.xp6(11),t.Q6J("ngIf",e.dataSourceUpload.data.length>0),t.xp6(1),t.Q6J("ngIf",e.dataSourceUpload.data.length>0)}}let y=class{constructor(i,e,a,n,r,l,_,h,A){this.actionService=i,this.sessionService=e,this.httpService=a,this.matDialog=n,this.activatedRoute=r,this.fileService=l,this.toastrService=_,this.appConfigService=h,this.router=A,this.isUpload=!1,this.title="Personal Documents",this.id="",this.displayedColumns=["lineNumber","attachment","remark","fileName","actions"],this.emptyGuid=u.i.empty,this.lastRowIndex=-1,this.acceptFile=C.jm}ngOnInit(){this.initializeToolbar(),this.selection=new et.Ov(!0,[]),this.dataSource=new d.by,this.inquiry=new q.U,this.inquiry.pageSize=999,this.inquiry.sortExpression="CreateOn",this.activatedRoute.queryParams.pipe((0,c.t)(this)).subscribe(i=>{this.id=i.id||"",0!==this.id.length&&this.id!==u.i.empty&&this.executeSearch()}),this.actionService.toggleRefreshEvent.pipe((0,c.t)(this)).subscribe(i=>this.executeSearch()),this.actionService.toggleCreateEvent.pipe((0,c.t)(this)).subscribe(i=>this.create(i))}executeSearch(){if(0===this.id.length||this.id===u.i.empty)return;let i=JSON.stringify(this.inquiry),e=JSON.parse(i);e.personalId=this.id,this.httpService.HttpPost(this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"personal/PersonalDocumentInquiry",JSON.stringify(e)).subscribe(n=>{this.inquirySuccess(n)},n=>this.inquiryFailed(n))}inquiryFailed(i){this.lastRowIndex=0}ngOnDestroy(){}initializeToolbar(){const i=new F.P;i.showReferesh=!0,i.showNavigatebefore=!0,i.navigatebeforeUrl="/dormitorymanagement/personal/inquiry",i.title=this.title,this.actionService.setToolbarSettings(i)}update(i){alert("documents from service sub")}onUpload(){this.isUpload=!this.isUpload,this.dataSourceUpload=new d.by}onFileChange(){if(this.dataSourceUpload.data.length>5)return;const i=this.fileUpload.nativeElement;let e=[];const a=C.$w;i.onchange=()=>{for(let n=0;n<i.files.length&&!(n>4);n++){const r=i.files[n];if(-1===a.indexOf(r.type)){e.push(r.name.concat(" ","not a accept file format."));continue}if(r.size/1024>C.Lj){this.toastrService.ShowErrorMessage(`Please choose file not excess ${C.Lj} KB`),e.push(r.name.concat(" ",`file size excess ${C.Lj} kb`));continue}let l=new z;l.file=r,l.fileName=r.name,this.dataSourceUpload.data.push(l)}e.length>0&&this.toastrService.ShowErrorMessage("",e),this.dataSourceUpload._updateChangeSubscription()},i.click()}deleteMutiple(i){if(this.selection.selected.length<=0)return;const a=new j.vA;a.autoFocus=!0,a.data=new it.B("Delete record?","Are you wants to delete selected record ","OK","Cancel",!1,null),this.matDialog.open(ot.z,a).afterClosed().subscribe(r=>{if(!0===r){let l=this.selection.selected.map(h=>h.id);this.httpService.HttpPost(this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"personal/DeletePersonalDocument",l).subscribe(h=>{this.deleteSuccess()},h=>this.showFailed(h))}})}deleteSuccess(){this.executeSearch(),this.selection.clear()}showFailed(i){}clear(){this.dataSourceUpload=new d.by}back(){}delete(i){this.dataSourceUpload.data.splice(i,1)}onUploadFile(){if(0===this.id.length||this.id===u.i.empty)return;let i=this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"personal/UploadPersonalDocument";const e=new FormData;let a=new Array;this.dataSourceUpload.data.forEach(n=>{let r=new z;r.fileName=n.fileName,r.remark=n.remark,r.personalId=this.id,e.append("file",n.file),a.push(r)}),e.append("model",JSON.stringify(a)),this.httpService.HttpFormData(i,e).subscribe(n=>{this.uploadSuccess(n)},n=>this.showFailed(n))}uploadSuccess(i){this.executeSearch(),this.isUpload=!this.isUpload}inquirySuccess(i){i.entity.map(e=>{switch(e.fileName.substring(e.fileName.lastIndexOf(".")+1)){case"xls":case"xlsx":e.img=this.appConfigService.getValue().excel,e.isImage=!1;break;case"pdf":e.img=this.appConfigService.getValue().pdf,e.isImage=!1;break;case"doc":case"docx":e.img=this.appConfigService.getValue().word,e.isImage=!1;break;case"png":case"jpg":case"jpeg":case"gif":e.img=this.fileService.loadImage(e.base64String),e.isImage=!0;break;default:e.img=this.appConfigService.getValue().empty,e.isImage=!1}}),this.dataSource.data=i.entity,this.dataSource._updateChangeSubscription(),this.lastRowIndex=i.entity.length}download(i){this.fileService.convertToBlob(i.base64String,i.fileName,w.T[w.T.base64]).then(e=>{this.fileService.downloadFile(e,i.fileName)})}create(i){this.actionService.toggleDataEvent.emit(null),this.router.navigate(["/dormitorymanagement/personal/maintenance"],{queryParams:{id:""}})}};y.\u0275fac=function(i){return new(i||y)(t.Y36(p.cw),t.Y36(p.mj),t.Y36(p.OE),t.Y36(j.uw),t.Y36(g.gz),t.Y36(nt.I),t.Y36(at._),t.Y36(J._),t.Y36(g.F0))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-personal-documents"]],viewQuery:function(i,e){if(1&i&&t.Gf(lt,5),2&i){let a;t.iGM(a=t.CRH())&&(e.fileUpload=a.first)}},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["upload",""],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","space-between center"],["fxLayout","row",1,"matero-group-button"],["fxLayout","row","fxLayoutAlign","center center"],["mat-icon-button","",3,"ngClass","click"],["aria-label","label"],["mat-icon-button","",3,"disabled","click"],["cols","4","rowHeight","1:1"],["style","background-color:rgb(189, 184, 184) ;",4,"ngFor","ngForOf"],[3,"lastRowIndex","title","message"],[2,"background-color","rgb(189, 184, 184)"],["matLine","",1,"f-s-12","f-w-200"],["fxFlex",""],[3,"checked","click","change"],["class","w-full h-full object-cover cursor-pointer",3,"src",4,"ngIf"],["class","object-cover cursor-pointer","width","50","height","50",3,"src",4,"ngIf"],[1,"f-s-12","f-w-200"],["mat-icon-button","",3,"click"],[1,"w-full","h-full","object-cover","cursor-pointer",3,"src"],["width","50","height","50",1,"object-cover","cursor-pointer",3,"src"],[1,"matero-group-button"],[2,"padding","16px"],["fxLayout","column","fxLayoutAlign","space-around center",1,"dropzone"],["src","assets/images/default/upload.png","alt","upload","width","60",3,"click"],["type","file","multiple","",1,"files",2,"display","none",3,"accept"],["fileUpload",""],["for","images"],["matLine",""],[1,"m-t-16","m-b-16"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["class","matero-table-container",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],[1,"matero-table-container"],["mat-table","",2,"border","0.5px solid #e0e0e0",3,"dataSource"],["matColumnDef","lineNumber"],["mat-header-cell","","style","width: 5%;",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","attachment"],["matColumnDef","remark"],["mat-header-cell","","style","width: 50%;",4,"matHeaderCellDef"],["matColumnDef","fileName"],["matColumnDef","actions","stickyEnd",""],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","",2,"width","5%"],["mat-cell",""],["color","primary"],["mat-header-cell","",2,"width","50%"],[1,"table-mat-form-field-daterange"],["matInput","","placeholder","Place your remark",3,"ngModel","ngModelChange"],["matInput","","readonly","",3,"ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(i,e){if(1&i&&(t.YNc(0,dt,14,10,"div",0),t.YNc(1,wt,26,3,"ng-template",null,1,t.W1O)),2&i){const a=t.MAs(2);t.Q6J("ngIf",!e.isUpload)("ngIfElse",a)}},directives:[f.O5,v.xw,v.Wh,E.lW,f.mk,rt.oO,Q.Hw,S.Il,f.sg,S.DX,S.$H,S.jo,Y.X2,v.yH,st.oG,S.Bv,W.B,d.BZ,d.w1,d.fO,d.ge,d.Dz,d.ev,T.KE,B.Nt,m.Fj,m.JJ,m.On,d.as,d.XQ,d.nj,d.Gk],styles:[""]}),y=(0,P.gn)([(0,c.c)()],y);var G=s(520),Ut=s(2802),U=s(4623),Nt=s(4834),Mt=s(2354);const It=["fileUpload"];function Dt(o,i){1&o&&t._UZ(0,"div",19)}function Ot(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",20,21),t.NdJ("click",function(){return t.CHM(e),t.oxw().removeImage()}),t.TgZ(2,"mat-icon"),t._uU(3,"delete"),t.qZA()()}}let b=class{constructor(i,e,a,n,r,l,_){this.actionService=i,this.sessionService=e,this.httpService=a,this.appConfigService=n,this.activatedRoute=r,this.fileService=l,this.router=_,this.entity=null,this.id="",this.avatar=null,this.name="",this.customer="",this.isMaintanance=!0,this.isNew=!1,this.acceptImage=C.Xp,this.subscription=this.actionService.toggleDataEvent.pipe((0,c.t)(this)).subscribe(h=>{this.update(h)})}ngOnInit(){this.standardAvatar=this.appConfigService.getValue().avatar,this.routerSubscription=this.activatedRoute.queryParams.pipe((0,c.t)(this)).subscribe(r=>{if(this.id=r.id||"",0===this.id.length||this.id===u.i.empty)return this.isMaintanance=this.isNew=!0,void this.router.navigate(["/dormitorymanagement/personal/maintenance"])});let n=this.router.parseUrl(this.router.url).root.children[g.eC].segments.join("/");(-1!==n.indexOf("dormitorymanagement/personal/occupancy")||-1!==n.indexOf("dormitorymanagement/personal/documents"))&&this.id.length>0&&this.id!==u.i.empty&&(this.isMaintanance=this.isNew=!1,this.get())}ngOnDestroy(){this.subscription.unsubscribe(),this.routerSubscription.unsubscribe()}optionsEvent(i){}update(i){this.isNew=!1;let e=i?i.status:"new";if("new"===e)return this.avatar=this.standardAvatar,this.name="",this.customer="",this.isNew=!0,void(this.id="");this.id=i.id,i.name!==this.name&&(this.name=i.name),i.customer!==this.customer&&(this.customer=i.customer),"get"===e&&i.avatar!==this.avatar&&(this.avatar=i.avatar)}get(){const i=(new G.LE).set("id",this.id);this.httpService.HttpGetWithParams(this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"personal/get",i).subscribe(a=>{this.getSuccess(a)},a=>this.getFailed(a))}getSuccess(i){this.name!==i.entity.name&&(this.name=i.entity.name),this.customer!==i.entity.customer&&(this.customer=i.entity.customer),this.id=i.entity.id,this.avatar=i.entity.base64String?this.fileService.loadImage(i.entity.base64String):this.standardAvatar,this.actionService.file=null,this.actionService.fileMode=""}getFailed(i){}onChange(i){if(!this.isMaintanance)return;let e=this.fileUpload.nativeElement;e.onchange=()=>{for(let a=0;a<e.files.length;a++){const n=e.files[a];this.fileService.uploadImage(n).pipe((0,c.t)(this)).subscribe(r=>{r?(this.avatar=r,this.actionService.file=n,this.actionService.fileMode="replace",this.actionService.toggleImageEvent.emit(!0)):this.fileUpload.nativeElement.value=""})}},e.click()}removeImage(){this.fileUpload.nativeElement.value="",this.actionService.file=null,this.actionService.fileMode="remove",this.avatar=this.standardAvatar,this.actionService.toggleImageEvent.emit(!0)}maintenance(){this.isMaintanance=!0,this.router.navigate(["/dormitorymanagement/personal/maintenance"],{queryParams:{id:this.id}})}occupancy(i){this.isNew||(this.isMaintanance=!1,this.router.navigate(["/dormitorymanagement/personal/occupancy"],{queryParams:{id:this.id}}))}documents(){this.isNew||(this.isMaintanance=!1,this.router.navigate(["/dormitorymanagement/personal/documents"],{queryParams:{id:this.id}}))}};b.\u0275fac=function(i){return new(i||b)(t.Y36(p.cw),t.Y36(p.mj),t.Y36(p.OE),t.Y36(J._),t.Y36(g.gz),t.Y36(p.Ip),t.Y36(g.F0))},b.\u0275cmp=t.Xpm({type:b,selectors:[["app-personal-layout"]],viewQuery:function(i,e){if(1&i&&t.Gf(It,5),2&i){let a;t.iGM(a=t.CRH())&&(e.fileUpload=a.first)}},decls:38,vars:5,consts:[["fxLayout","row wrap",2,"height","calc(100% - 50px)"],["fxFlex","100","fxFlex.gt-xs","30","fxFlex.gt-sm","30","fxFlex.gt-md","20",2,"background-color","#f1eaea"],["fxLayout","column"],["fxLayout","column",1,"panel-content"],[1,"image-container"],["alt","",1,"img-120",3,"src","click"],["type","file","id","fileUpload","name","fileUpload",2,"display","none",3,"accept"],["fileUpload",""],["class","overlay",4,"ngIf"],["class","button","mat-mini-fab","","color","warn",3,"click",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center"],[1,"f-s-16","f-w-600"],[2,"margin-top","10px"],["mat-list-item","",2,"padding","0 20px",3,"click"],[1,"icon-18","m-r-8"],[1,"f-s-14","f-w-100"],["fxFlex","100","fxFlex.gt-xs","70","fxFlex.gt-sm","70","fxFlex.gt-md","80"],[1,"content"],[3,"optionsEvent"],[1,"overlay"],["mat-mini-fab","","color","warn",1,"button",3,"click"],["deleteBtn",""]],template:function(i,e){1&i&&(t._UZ(0,"app-page-header"),t.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"img",5),t.NdJ("click",function(n){return e.onChange(n)}),t.qZA(),t._UZ(7,"input",6,7),t.YNc(9,Dt,1,0,"div",8),t.YNc(10,Ot,4,0,"button",9),t.qZA()(),t.TgZ(11,"div",10)(12,"span",11),t._uU(13),t.qZA()(),t.TgZ(14,"mat-nav-list",12),t._UZ(15,"mat-divider"),t.TgZ(16,"a",13),t.NdJ("click",function(){return e.maintenance()}),t.TgZ(17,"mat-icon",14),t._uU(18,"account_circle"),t.qZA(),t.TgZ(19,"p",15),t._uU(20,"Profile"),t.qZA()(),t._UZ(21,"mat-divider"),t.TgZ(22,"a",13),t.NdJ("click",function(n){return e.occupancy(n)}),t.TgZ(23,"mat-icon",14),t._uU(24,"settings"),t.qZA(),t.TgZ(25,"p",15),t._uU(26,"Occupancy Transaction"),t.qZA()(),t._UZ(27,"mat-divider"),t.TgZ(28,"a",13),t.NdJ("click",function(){return e.documents()}),t.TgZ(29,"mat-icon",14),t._uU(30,"settings"),t.qZA(),t.TgZ(31,"p",15),t._uU(32,"Documents"),t.qZA()(),t._UZ(33,"mat-divider"),t.qZA()()(),t.TgZ(34,"div",16)(35,"div",17),t._UZ(36,"router-outlet"),t.qZA()()(),t.TgZ(37,"app-float-button",18),t.NdJ("optionsEvent",function(n){return e.optionsEvent(n)}),t.qZA()),2&i&&(t.xp6(6),t.Q6J("src",e.avatar,t.LSH),t.xp6(1),t.Q6J("accept",e.acceptImage),t.xp6(2),t.Q6J("ngIf",e.isMaintanance),t.xp6(1),t.Q6J("ngIf",e.isMaintanance),t.xp6(3),t.Oqu(e.name))},directives:[Ut.q,v.xw,v.yH,f.O5,E.lW,Q.Hw,v.Wh,U.Hk,Nt.d,U.Tg,g.lC,Mt.u],styles:[".content[_ngcontent-%COMP%]{margin-top:0;overflow-y:hidden;overflow-x:hidden}"]}),b=(0,P.gn)([(0,c.c)()],b);var kt=s(1135),qt=s(8372);class L{constructor(){this.id=u.i.empty,this.name="",this.gender="",this.birthDate=null,this.idNumber="",this.nationalityId=null,this.nationality="",this.raceId=null,this.race="",this.mobile="",this.telephone="",this.emailAddress="",this.address="",this.city="",this.region="",this.postalCode="",this.countryId=null,this.country="",this.workPermitNumber="",this.workPermitExpiry=null,this.passportNumber="",this.passportExpiry=null,this.customerId=u.i.empty,this.customer="",this.hireDate=new Date,this.resignDate=null,this.position="",this.cardNumber="",this.photo=null,this.base64String=null}}var V=s(3251),R=s(6856),Ft=s(6744),Jt=s(4107),X=s(1079),Et=s(9285);function Qt(o,i){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Yt(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,Qt,3,1,"ng-container",58),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("name").errors,"name"))}}function Lt(o,i){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Rt(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,Lt,3,1,"ng-container",58),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("birthDate").errors,"birthDate"))}}function Ht(o,i){1&o&&(t.TgZ(0,"mat-error"),t._uU(1,"Please select gender"),t.qZA())}function $t(o,i){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}function jt(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,$t,3,1,"ng-container",58),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("idNumber").errors,"idNumber"))}}function zt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(n){t.CHM(e);const r=t.oxw(),l=t.MAs(37);return r.clearInput(n,"nationality",l)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function Wt(o,i){if(1&o&&(t.TgZ(0,"mat-option",59),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function Bt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(n){t.CHM(e);const r=t.oxw(),l=t.MAs(51);return r.clearInput(n,"race",l)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function Gt(o,i){if(1&o&&(t.TgZ(0,"mat-option",59),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function Vt(o,i){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Xt(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,Vt,3,1,"ng-container",58),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("name").errors,"name"))}}function Kt(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(n){t.CHM(e);const r=t.oxw(),l=t.MAs(87);return r.clearInput(n,"country",l)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function te(o,i){if(1&o&&(t.TgZ(0,"mat-option",59),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function ee(o,i){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}function ie(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,ee,3,1,"ng-container",58),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("workPermitExpiry").errors,"workPermitExpiry"))}}function oe(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(n){t.CHM(e);const r=t.oxw(),l=t.MAs(139);return r.clearInput(n,"customer",l)}),t.TgZ(1,"mat-icon"),t._uU(2,"clear"),t.qZA()()}}function ne(o,i){if(1&o&&(t.TgZ(0,"mat-option",59),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.description)," ")}}function ae(o,i){if(1&o&&(t.ynx(0),t._uU(1),t._UZ(2,"br"),t.BQk()),2&o){const e=i.$implicit;t.xp6(1),t.hij(" ",e," ")}}function re(o,i){if(1&o&&(t.TgZ(0,"mat-error"),t.YNc(1,ae,3,1,"ng-container",58),t.ALo(2,"matError"),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.form.get("customer").errors,"customer"))}}let x=class{constructor(i,e,a,n,r,l,_,h,A,N,M){this.fb=i,this.httpService=e,this.sessionService=a,this.router=n,this.activatedRoute=r,this.toastrService=l,this.actionService=_,this.fileService=h,this.lookupService=A,this.reactiveformService=N,this.appConfigService=M,this.title="Profile Maintenance",this.nationalityAutoComplete$=null,this.raceAutoComplete$=null,this.countryAutoComplete$=null,this.customerAutoComplete$=null,this.selectedCountry=null,this.selectedRace=null,this.selectedCustomer=null,this.selectedNationality=null,this.id="",this.createMode=new kt.X(!0),this._createMode$=this.createMode.asObservable()}ngOnInit(){this.initialize(),this.initializeToolbar(),this.initializeForm(new L),this.updateEventSubscription=this.actionService.toggleUpdateEvent.pipe((0,c.t)(this)).subscribe(i=>this.update(i)),this.createNewEventSubscription=this.actionService.toggleCreateEvent.pipe((0,c.t)(this)).subscribe(i=>this.create(i)),this.getEventSubscription=this.actionService.toggleGetEvent.pipe((0,c.t)(this)).subscribe(i=>{this.id=i,this.get()}),this.toggleImageEvent=this.actionService.toggleImageEvent.pipe((0,c.t)(this)).subscribe(i=>{36===this.id.length&&this.id!==u.i.empty&&(this.actionService.formDirty=!0)}),this.downloadEventSubscription=this.actionService.toggleDownloadEvent.pipe((0,c.t)(this)).subscribe(i=>{this.download(i)}),this._createMode$.pipe((0,c.t)(this)).subscribe(i=>{this.toolbarModel.showDownload=!i,this.actionService.setToolbarSettings(this.toolbarModel)}),this.routerSubscription=this.activatedRoute.queryParams.pipe((0,c.t)(this)).subscribe(i=>{this.id=i.id||"",this.id.length>0&&this.id!==u.i.empty&&this.get()}),this.form.valueChanges.pipe((0,c.t)(this),(0,qt.b)(500),(0,$.Lr)()).subscribe(i=>{this.actionService.formDirty=!(!this.form.valid||!this.form.touched&&!this.form.dirty)})}initialize(){this.inquiry=new q.U,this.inquiry.sortExpression="name",this.countryArrow=this.raceArrow=this.customerArrow=this.nationalityArrow="arrow_drop_down",this.countryObs=this.raceObs=this.customerObs=this.nationalityObs=!1}ngOnDestroy(){}ngAfterViewInit(){this.initReferences()}initializeToolbar(){this.toolbarModel=new F.P,this.toolbarModel.showNavigatebefore=!0,this.toolbarModel.showSave=!0,this.toolbarModel.navigatebeforeUrl="/dormitorymanagement/personal/inquiry",this.toolbarModel.title=this.title,this.actionService.setToolbarSettings(this.toolbarModel)}get(){const i=this.id,e=(new G.LE).set("id",i);this.httpService.HttpGetWithParams(this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"personal/get",e).subscribe(n=>{this.getSuccess(n)},n=>this.showError(n))}getSuccess(i){this.id=i.entity.id,this.createMode.next(!1),this.reactiveformService.setReactiveFormObject(this.form,i.entity),this.patchAutoComplete(i.entity);let e={status:"get",id:i.entity.id,name:i.entity.name,customer:i.entity.customer,avatar:i.entity.base64String?this.fileService.loadImage(i.entity.base64String):this.appConfigService.getValue().avatar};this.actionService.toggleDataEvent.emit(e),this.actionService.file=null,this.actionService.fileMode=""}showError(i){let e=i.error;this.toastrService.ShowErrorMessage(i.status>0&&e.returnMessage?e.returnMessage[0]:i.message)}create(i){this.id="",this.createMode.next(!0),this.reactiveformService.setReactiveFormObject(this.form,new L),this.patchAutoComplete(null),this.countryObs=this.raceObs=this.customerObs=this.nationalityObs=!0,this.actionService.toggleDataEvent.emit({status:"new"}),this.actionService.file=null,this.actionService.fileMode=""}update(i){let e=new L;e=this.reactiveformService.getReactiveFormObject(this.form);let a="";a=this.sessionService.urlSetting.dormitoryManagementWebApiUrl+(e.id===u.i.empty||""===e.id||null==e.id?"personal/create":"personal/update"),e.id=null===e.id?u.i.empty:e.id,e.country=e.nationality=e.race=e.customer=null;const n=new FormData;this.actionService.file&&n.append("file",this.actionService.file),n.append("model",JSON.stringify(e)),n.append("mode",this.actionService.fileMode),this.httpService.HttpFormData(a,n).subscribe(r=>{this.updateSuccess(r)},r=>this.updateFailed(r))}updateSuccess(i){this.id=i.entity.id,this.createMode.next(!1),this.toastrService.ShowSuccessMessage(i.returnMessage[0]);let e={status:"update",id:i.entity.id,name:this.form.get("name").value,customer:this.form.get("customer").value,avatar:null};this.actionService.toggleDataEvent.emit(e),this.actionService.file=null,this.actionService.fileMode=""}updateFailed(i){}initializeForm(i){this.form=this.fb.group({id:[i.id],name:[i.name,[m.kI.required]],gender:[i.gender,[m.kI.required]],birthDate:[i.birthDate,[m.kI.required]],idNumber:[i.idNumber,[m.kI.required,m.kI.maxLength(200),m.kI.minLength(5)]],nationalityId:[i.nationalityId],nationality:[i.nationality],raceId:[i.raceId],race:[i.race],emailAddress:[i.emailAddress,[m.kI.email,m.kI.maxLength(200)]],address:[i.address],city:[i.city],region:[i.region],postalCode:[i.postalCode],countryId:[i.countryId],country:[i.country],mobile:[i.mobile],telephone:[i.telephone],workPermitNumber:[i.workPermitNumber],workPermitExpiry:[i.workPermitExpiry],passportNumber:[i.passportNumber],passportExpiry:[i.passportExpiry],customerId:[i.customerId,[m.kI.required]],customer:[i.customer,[m.kI.required]],hireDate:[i.hireDate],resignDate:[i.resignDate],position:[i.position],cardNumber:[i.cardNumber]})}download(i){if(this.createMode.getValue()||0===this.id.length||this.id===u.i.empty)return;let e=new Array;e.push(this.id),this.httpService.HttpPost(this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"personal/downloadPersonal",JSON.stringify({renderType:i,guids:e,format:"personalProfile"})).subscribe(r=>{this.downloadSuccess(r.entity)},r=>this.downloadFailed(r))}downloadSuccess(i){this.fileService.convertToBlob(i.base64,i.fileName,w.T[w.T.base64]).then(e=>{this.fileService.downloadFile(e,i.fileName)})}downloadFailed(i){}optionSelected(i,e,a,n,r){const l=i.option.value?i.option.value:null;"object"==typeof l&&(this[e]=l,n.controls[a].patchValue(l[r]))}validateSelected(i,e,a,n,r){setTimeout(()=>{this[i]&&this[i][r]===n.controls[a].value?n.controls[e].patchValue(this[i].id):(n.controls[a].patchValue(""),n.controls[e].patchValue(""),this[i]="")},300)}clearInput(i,e,a){i.stopPropagation(),this.form.get(e).patchValue(""),a.openPanel()}openOrClosePanel(i,e,a){i.stopPropagation(),e.panelOpen?e.closePanel():(this.obs(a),e.openPanel())}initReferences(){this.nationalityAutoComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"nationality",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/getNationalities","description","nationalityObs"),this.countryAutoComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"country",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/GetCoutries","description","countryObs"),this.raceAutoComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"race",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/GetRaces","description","raceObs"),this.customerAutoComplete$=this.lookupService.autoCompleteSkipOneObs(this.form,"customer",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/GetCustomers","description","customerObs")}patchAutoComplete(i){if(null===i)return this.selectedCountry=null,this.selectedCustomer=null,this.selectedRace=null,void(this.selectedNationality=null);this.selectedCountry={id:i.countryId,description:i.country},this.selectedCustomer={id:i.customerId,description:i.customer},this.selectedRace={id:i.raceId,description:i.race},this.selectedNationality={id:i.nationalityId,description:i.nationality}}obs(i){(new q.U).sortExpression="description",this[i]||"nationalityObs"!==i?this[i]||"raceObs"!==i?this[i]||"countryObs"!==i?!this[i]&&"customerObs"===i&&(this.customerAutoComplete$=this.lookupService.autoCompleteObs(this.form,"customer",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/GetCustomers","description","customerObs")):this.countryAutoComplete$=this.lookupService.autoCompleteObs(this.form,"country",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/GetCoutries","description","countryObs"):this.raceAutoComplete$=this.lookupService.autoCompleteObs(this.form,"race",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/GetRaces","description","raceObs"):this.nationalityAutoComplete$=this.lookupService.autoCompleteObs(this.form,"nationality",this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"references/getNationalities","description","nationalityObs"),this[i]=!0}};x.\u0275fac=function(i){return new(i||x)(t.Y36(m.qu),t.Y36(p.OE),t.Y36(p.mj),t.Y36(g.F0),t.Y36(g.gz),t.Y36(p._W),t.Y36(p.cw),t.Y36(p.Ip),t.Y36(p.WO),t.Y36(p.xd),t.Y36(J._))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-profile-maintenance"]],decls:172,vars:43,consts:[["label","Profile"],["autocomplete","off",2,"overflow","hidden",3,"formGroup"],["fxLayout","row wrap","fxLayoutGap","5px grid",1,"matero-mat-form-field"],["fxFlex","70","fxFlex.lt-md","100","fxFlex.lt-md","100"],["matInput","","placeholder","name","formControlName","name","appUppercase",""],[4,"ngIf"],["fxFlex","30","fxFlex.lt-sm","100","fxFlex.lt-md","100"],["matInput","","appDatemask","","formControlName","birthDate",2,"text-decoration","none",3,"matDatepicker"],["matSuffix","",3,"for"],["birthDate",""],["fxFlex","20","fxFlex.lt-md","50","fxFlex.lt-sm","100"],["formControlName","gender"],["value","Male"],["value","Female"],["fxFlex","40","fxFlex.lt-md","50","fxFlex.lt-sm","100"],["matInput","","placeholder","ID no.","formControlName","idNumber"],["matInput","","formControlName","nationality",3,"matAutocomplete","blur"],["nationalityTrigger","matAutocompleteTrigger"],["matSuffix","",2,"display","flex"],["mat-icon-button","","type","button",3,"click",4,"ngIf"],["mat-icon-button","","type","button",3,"click"],[3,"closed","opened","optionSelected"],["nationalityId","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","50","fxFlex.lt-md","50","fxFlex.lt-sm","100"],["matInput","","formControlName","race","placeholder","Race",3,"matAutocomplete","blur"],["raceTrigger","matAutocompleteTrigger"],["raceId","matAutocomplete"],["matInput","","formControlName","emailAddress","placeholder","Email"],["fxFlex","100","fxFlex.lt-md","100"],["matInput","","formControlName","address","placeholder","Address"],["fxFlex","50","fxFlex.lt-md","100"],["matInput","","formControlName","city","placeholder","City"],["matInput","","formControlName","region","placeholder","Region"],["matInput","","formControlName","postalCode","placeholder","Postal Code"],["matInput","","formControlName","country",3,"matAutocomplete","blur"],["countryTrigger","matAutocompleteTrigger"],["country","matAutocomplete"],["matInput","","type","number","formControlName","mobile","placeholder","Mobile"],["matSuffix",""],["matInput","","type","number","formControlName","telephone","placeholder","Telephone"],["matInput","","type","text","formControlName","workPermitNumber","placeholder","Work Permit No."],["matInput","","formControlName","workPermitExpiry","appDatemask","",3,"matDatepicker"],["workPermitExpiry",""],["matInput","","formControlName","passportNumber","placeholder","Passport No.","type","text"],["matInput","","formControlName","passportExpiry","appDatemask","",3,"matDatepicker"],["passportExpiry",""],["label","Employment"],[2,"overflow","hidden",3,"formGroup"],["matInput","","formControlName","customer","type","text",3,"matAutocomplete","blur"],["customerTrigger","matAutocompleteTrigger"],["customerId","matAutocomplete"],["matInput","","formControlName","hireDate","appDatemask","",3,"matDatepicker"],["hireDate",""],["matInput","","formControlName","resignDate","appDatemask","",3,"matDatepicker"],["resignDate",""],["matInput","","formControlName","position","placeholder","Designation"],["matInput","","formControlName","cardNumber","placeholder","Card No."],[4,"ngFor","ngForOf"],[3,"value"]],template:function(i,e){if(1&i){const a=t.EpF();t.TgZ(0,"mat-tab-group")(1,"mat-tab",0)(2,"form",1)(3,"div",2)(4,"mat-form-field",3)(5,"mat-label"),t._uU(6,"Name"),t.qZA(),t._UZ(7,"input",4),t.YNc(8,Yt,3,4,"mat-error",5),t.qZA(),t.TgZ(9,"mat-form-field",6)(10,"mat-label"),t._uU(11,"DOB"),t.qZA(),t._UZ(12,"input",7)(13,"mat-datepicker-toggle",8)(14,"mat-datepicker",null,9),t.YNc(16,Rt,3,4,"mat-error",5),t.qZA(),t.TgZ(17,"mat-form-field",10)(18,"mat-label"),t._uU(19,"Gender"),t.qZA(),t.TgZ(20,"mat-select",11)(21,"mat-option"),t._uU(22,"-- None --"),t.qZA(),t.TgZ(23,"mat-option",12),t._uU(24,"Male"),t.qZA(),t.TgZ(25,"mat-option",13),t._uU(26,"Female"),t.qZA()(),t.YNc(27,Ht,2,0,"mat-error",5),t.qZA(),t.TgZ(28,"mat-form-field",14)(29,"mat-label"),t._uU(30,"ID"),t.qZA(),t._UZ(31,"input",15),t.YNc(32,jt,3,4,"mat-error",5),t.qZA(),t.TgZ(33,"mat-form-field",14)(34,"mat-label"),t._uU(35,"Nationality"),t.qZA(),t.TgZ(36,"input",16,17),t.NdJ("blur",function(){return e.validateSelected("selectedNationality","nationalityId","nationality",e.form,"description")}),t.qZA(),t.TgZ(38,"div",18),t.YNc(39,zt,3,0,"button",19),t.TgZ(40,"button",20),t.NdJ("click",function(r){t.CHM(a);const l=t.MAs(37);return e.openOrClosePanel(r,l,"nationalityObs")}),t.TgZ(41,"mat-icon"),t._uU(42),t.qZA()()(),t.TgZ(43,"mat-autocomplete",21,22),t.NdJ("closed",function(){return e.nationalityArrow="arrow_drop_down"})("opened",function(){return e.nationalityArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedNationality","nationality",e.form,"description")}),t.YNc(45,Wt,3,4,"mat-option",23),t.ALo(46,"async"),t.qZA()(),t.TgZ(47,"mat-form-field",24)(48,"mat-label"),t._uU(49,"Race"),t.qZA(),t.TgZ(50,"input",25,26),t.NdJ("blur",function(){return e.validateSelected("selectedRace","raceId","race",e.form,"description")}),t.qZA(),t.TgZ(52,"div",18),t.YNc(53,Bt,3,0,"button",19),t.TgZ(54,"button",20),t.NdJ("click",function(r){t.CHM(a);const l=t.MAs(51);return e.openOrClosePanel(r,l,"raceObs")}),t.TgZ(55,"mat-icon"),t._uU(56),t.qZA()()(),t.TgZ(57,"mat-autocomplete",21,27),t.NdJ("closed",function(){return e.raceArrow="arrow_drop_down"})("opened",function(){return e.raceArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedRace","race",e.form,"description")}),t.YNc(59,Gt,3,4,"mat-option",23),t.ALo(60,"async"),t.qZA()(),t.TgZ(61,"mat-form-field",24)(62,"mat-label"),t._uU(63,"Email"),t.qZA(),t._UZ(64,"input",28),t.YNc(65,Xt,3,4,"mat-error",5),t.qZA(),t.TgZ(66,"mat-form-field",29)(67,"mat-label"),t._uU(68,"Address"),t.qZA(),t.TgZ(69,"textarea",30),t._uU(70,"              "),t.qZA()(),t.TgZ(71,"mat-form-field",31)(72,"mat-label"),t._uU(73,"City"),t.qZA(),t._UZ(74,"input",32),t.qZA(),t.TgZ(75,"mat-form-field",31)(76,"mat-label"),t._uU(77,"Region"),t.qZA(),t._UZ(78,"input",33),t.qZA(),t.TgZ(79,"mat-form-field",31)(80,"mat-label"),t._uU(81,"Postal Code"),t.qZA(),t._UZ(82,"input",34),t.qZA(),t.TgZ(83,"mat-form-field",31)(84,"mat-label"),t._uU(85,"Country"),t.qZA(),t.TgZ(86,"input",35,36),t.NdJ("blur",function(){return e.validateSelected("selectedCountry","countryId","country",e.form,"description")}),t.qZA(),t.TgZ(88,"div",18),t.YNc(89,Kt,3,0,"button",19),t.TgZ(90,"button",20),t.NdJ("click",function(r){t.CHM(a);const l=t.MAs(87);return e.openOrClosePanel(r,l,"countryObs")}),t.TgZ(91,"mat-icon"),t._uU(92),t.qZA()()(),t.TgZ(93,"mat-autocomplete",21,37),t.NdJ("closed",function(){return e.countryArrow="arrow_drop_down"})("opened",function(){return e.countryArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedCountry","country",e.form,"description")}),t.YNc(95,te,3,4,"mat-option",23),t.ALo(96,"async"),t.qZA()(),t.TgZ(97,"mat-form-field",31)(98,"mat-label"),t._uU(99,"Mobile"),t.qZA(),t._UZ(100,"input",38),t.TgZ(101,"mat-icon",39),t._uU(102,"smartphone"),t.qZA()(),t.TgZ(103,"mat-form-field",31)(104,"mat-label"),t._uU(105,"Telephone"),t.qZA(),t._UZ(106,"input",40),t.TgZ(107,"mat-icon",39),t._uU(108,"phone"),t.qZA()(),t.TgZ(109,"mat-form-field",31)(110,"mat-label"),t._uU(111,"Work Permit"),t.qZA(),t._UZ(112,"input",41),t.qZA(),t.TgZ(113,"mat-form-field",31)(114,"mat-label"),t._uU(115,"Work Permit Expiry"),t.qZA(),t._UZ(116,"input",42)(117,"mat-datepicker-toggle",8)(118,"mat-datepicker",null,43),t.YNc(120,ie,3,4,"mat-error",5),t.qZA(),t.TgZ(121,"mat-form-field",31)(122,"mat-label"),t._uU(123,"Passport"),t.qZA(),t._UZ(124,"input",44),t.qZA(),t.TgZ(125,"mat-form-field",31)(126,"mat-label"),t._uU(127,"Passport Expiry"),t.qZA(),t._UZ(128,"input",45)(129,"mat-datepicker-toggle",8)(130,"mat-datepicker",null,46),t.qZA()()()(),t.TgZ(132,"mat-tab",47)(133,"form",48)(134,"div",2)(135,"mat-form-field",31)(136,"mat-label"),t._uU(137,"Company"),t.qZA(),t.TgZ(138,"input",49,50),t.NdJ("blur",function(){return e.validateSelected("selectedCustomer","customerId","customer",e.form,"description")}),t.qZA(),t.TgZ(140,"div",18),t.YNc(141,oe,3,0,"button",19),t.TgZ(142,"button",20),t.NdJ("click",function(r){t.CHM(a);const l=t.MAs(139);return e.openOrClosePanel(r,l,"customerObs")}),t.TgZ(143,"mat-icon"),t._uU(144),t.qZA()()(),t.TgZ(145,"mat-autocomplete",21,51),t.NdJ("closed",function(){return e.customerArrow="arrow_drop_down"})("opened",function(){return e.customerArrow="arrow_drop_up"})("optionSelected",function(r){return e.optionSelected(r,"selectedCustomer","customer",e.form,"description")}),t.YNc(147,ne,3,4,"mat-option",23),t.ALo(148,"async"),t.qZA(),t.YNc(149,re,3,4,"mat-error",5),t.qZA(),t.TgZ(150,"mat-form-field",31)(151,"mat-label"),t._uU(152,"Hire Date"),t.qZA(),t._UZ(153,"input",52)(154,"mat-datepicker-toggle",8)(155,"mat-datepicker",null,53),t.qZA(),t.TgZ(157,"mat-form-field",31)(158,"mat-label"),t._uU(159,"Resign Date"),t.qZA(),t._UZ(160,"input",54)(161,"mat-datepicker-toggle",8)(162,"mat-datepicker",null,55),t.qZA(),t.TgZ(164,"mat-form-field",31)(165,"mat-label"),t._uU(166,"Position"),t.qZA(),t._UZ(167,"input",56),t.qZA(),t.TgZ(168,"mat-form-field",31)(169,"mat-label"),t._uU(170,"Card Number"),t.qZA(),t._UZ(171,"input",57),t.qZA()()()()()}if(2&i){const a=t.MAs(15),n=t.MAs(44),r=t.MAs(58),l=t.MAs(94),_=t.MAs(119),h=t.MAs(131),A=t.MAs(146),N=t.MAs(156),M=t.MAs(163);let I,D,O,k;t.xp6(2),t.Q6J("formGroup",e.form),t.xp6(6),t.Q6J("ngIf",e.form.get("name").invalid&&(e.form.get("name").dirty||e.form.get("name").touched)),t.xp6(4),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(3),t.Q6J("ngIf",e.form.get("birthDate").invalid&&(e.form.get("birthDate").dirty||e.form.get("birthDate").touched)),t.xp6(11),t.Q6J("ngIf",e.form.get("gender").invalid),t.xp6(5),t.Q6J("ngIf",e.form.get("idNumber").invalid&&(e.form.get("idNumber").dirty||e.form.get("idNumber").touched)),t.xp6(4),t.Q6J("matAutocomplete",n),t.xp6(3),t.Q6J("ngIf",null!==(null==(I=e.form.get("nationality"))?null:I.value)&&""!==(null==(I=e.form.get("nationality"))?null:I.value)),t.xp6(3),t.Oqu(e.nationalityArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(46,35,e.nationalityAutoComplete$)),t.xp6(5),t.Q6J("matAutocomplete",r),t.xp6(3),t.Q6J("ngIf",null!==(null==(D=e.form.get("race"))?null:D.value)&&""!==(null==(D=e.form.get("race"))?null:D.value)),t.xp6(3),t.Oqu(e.raceArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(60,37,e.raceAutoComplete$)),t.xp6(6),t.Q6J("ngIf",e.form.get("name").invalid&&(e.form.get("name").dirty||e.form.get("name").touched)),t.xp6(21),t.Q6J("matAutocomplete",l),t.xp6(3),t.Q6J("ngIf",null!==(null==(O=e.form.get("country"))?null:O.value)&&""!==(null==(O=e.form.get("country"))?null:O.value)),t.xp6(3),t.Oqu(e.countryArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(96,39,e.countryAutoComplete$)),t.xp6(21),t.Q6J("matDatepicker",_),t.xp6(1),t.Q6J("for",_),t.xp6(3),t.Q6J("ngIf",e.form.get("workPermitExpiry").invalid&&(e.form.get("workPermitExpiry").dirty||e.form.get("workPermitExpiry").touched)),t.xp6(8),t.Q6J("matDatepicker",h),t.xp6(1),t.Q6J("for",h),t.xp6(4),t.Q6J("formGroup",e.form),t.xp6(5),t.Q6J("matAutocomplete",A),t.xp6(3),t.Q6J("ngIf",null!==(null==(k=e.form.get("customer"))?null:k.value)&&""!==(null==(k=e.form.get("customer"))?null:k.value)),t.xp6(3),t.Oqu(e.customerArrow),t.xp6(3),t.Q6J("ngForOf",t.lcZ(148,41,e.customerAutoComplete$)),t.xp6(2),t.Q6J("ngIf",e.form.get("customer").invalid&&(e.form.get("customer").dirty||e.form.get("customer").touched)),t.xp6(4),t.Q6J("matDatepicker",N),t.xp6(1),t.Q6J("for",N),t.xp6(6),t.Q6J("matDatepicker",M),t.xp6(1),t.Q6J("for",M)}},directives:[V.SP,V.uX,m._Y,m.JL,m.sg,v.xw,v.SQ,T.KE,v.yH,T.hX,B.Nt,m.Fj,m.JJ,m.u,f.O5,T.TO,f.sg,R.hl,Ft.v,R.nW,T.R9,R.Mq,Jt.gD,Y.ey,X.ZL,E.lW,Q.Hw,X.XC,m.wV],pipes:[Et.h,f.Ov,f.rS],styles:["mat-tab[_ngcontent-%COMP%]{overflow:auto}mat-tab-group[_ngcontent-%COMP%]{overflow:auto;overflow-y:hidden}"]}),x=(0,P.gn)([(0,c.c)()],x);var se=s(2231),le=s(2003),ce=s(6087);function me(o,i){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.dateTo))}}function ue(o,i){1&o&&(t.TgZ(0,"span"),t._uU(1,"present"),t.qZA())}function pe(o,i){if(1&o&&(t.TgZ(0,"mat-list-item")(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"h3",7),t._uU(6),t.qZA(),t.TgZ(7,"h2",8)(8,"span"),t._uU(9),t.ALo(10,"date"),t.qZA(),t.YNc(11,me,3,3,"span",9),t.YNc(12,ue,2,0,"span",9),t.qZA()(),t.TgZ(13,"div",10)(14,"p",8)(15,"span"),t._uU(16),t.qZA()(),t.TgZ(17,"p",8)(18,"span"),t._uU(19),t.qZA()()()()()()()),2&o){const e=i.$implicit;t.xp6(6),t.hij(" ",e.fullAddress," "),t.xp6(3),t.hij("",t.lcZ(10,6,e.dateFrom)," - "),t.xp6(2),t.Q6J("ngIf",null!==e.dateTo),t.xp6(1),t.Q6J("ngIf",null===e.dateTo),t.xp6(4),t.hij("",e.category," "),t.xp6(3),t.hij("",e.location," ")}}let Z=class{constructor(i,e,a,n,r){this.sessionService=i,this.httpService=e,this.activatedRoute=a,this.actionService=n,this.router=r,this.lastRowIndex=-1,this.id=""}ngOnInit(){this.initializeToolbar(),this.initialize(),this.activatedRoute.queryParams.pipe((0,c.t)(this)).subscribe(i=>{this.id=i.id||"",0!==this.id.length&&this.id!==u.i.empty&&this.executeSearch()}),this.actionService.toggleRefreshEvent.pipe((0,c.t)(this)).subscribe(i=>this.executeSearch()),this.actionService.toggleCreateEvent.pipe((0,c.t)(this)).subscribe(i=>this.create(i))}initialize(){this.inquiry=new se.yR,this.inquiry.sortExpression="dateFrom",this.inquiry.sortDirection="DESC",this.dataSource=new d.by}initializeToolbar(){const i=new F.P;i.showReferesh=!0,i.showNavigatebefore=!0,i.title="Occupancy Transaction",i.navigatebeforeUrl="/dormitorymanagement/personal/inquiry",this.actionService.setToolbarSettings(i)}executeSearch(){0!==this.id.length&&this.id!==u.i.empty&&(this.inquiry.personalId=this.id,this.httpService.HttpPost(this.sessionService.urlSetting.dormitoryManagementWebApiUrl+"occupancy/GetOccupancyByPersonId",this.inquiry).subscribe(e=>{this.getSuccess(e)},e=>this.getFailed(e)))}getSuccess(i){this.lastRowIndex=i.entity.length,this.dataSource.data=i.entity,this.inquiry.totalPages=i.totalPages,this.inquiry.totalRows=i.totalRows,this.dataSource._updateChangeSubscription()}getFailed(i){this.lastRowIndex=0}onPaginateChange(i){this.inquiry.currentPageNumber=i.pageIndex+1,this.inquiry.pageSize=i.pageSize,this.executeSearch()}sortData(i){this.inquiry.currentPageNumber=1,this.inquiry.sortDirection=i.direction,this.inquiry.sortExpression=i.active,this.executeSearch()}create(i){this.actionService.toggleDataEvent.emit(null),this.router.navigate(["/dormitorymanagement/personal/maintenance"],{queryParams:{id:""}})}};Z.\u0275fac=function(i){return new(i||Z)(t.Y36(p.mj),t.Y36(p.OE),t.Y36(g.gz),t.Y36(le.c),t.Y36(g.F0))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["app-personal-occupancy"]],decls:4,vars:9,consts:[[3,"length","showFirstLastButtons","pageSize","pageIndex","pageSizeOptions","page"],[4,"ngFor","ngForOf"],[3,"lastRowIndex","title","message"],["fxLayout","row wrap",2,"width","100%"],["fxFlex","100","fxFlex.xs","100","fxFlex.sm","100"],["fxLayout","row wrap","fxLayout.xs","column"],["fxFlex","60"],["matLine","",2,"white-space","normal","word-break","normal"],["matLine",""],[4,"ngIf"],["fxFlex","40"]],template:function(i,e){1&i&&(t.TgZ(0,"mat-paginator",0),t.NdJ("page",function(n){return e.onPaginateChange(n)}),t.qZA(),t.TgZ(1,"mat-list"),t.YNc(2,pe,20,8,"mat-list-item",1),t.qZA(),t._UZ(3,"app-empty-layout",2)),2&i&&(t.Q6J("length",e.inquiry.totalRows)("showFirstLastButtons",!0)("pageSize",e.inquiry.pageSize)("pageIndex",e.inquiry.currentPageIndex)("pageSizeOptions",e.inquiry.pageSizeOptions),t.xp6(2),t.Q6J("ngForOf",e.dataSource.data),t.xp6(1),t.Q6J("lastRowIndex",e.lastRowIndex)("title","Oops!")("message","No record found"))},directives:[ce.NW,U.i$,f.sg,U.Tg,v.xw,v.yH,Y.X2,f.O5,W.B],pipes:[f.uU],styles:["mat-list-item[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0}mat-list-item[_ngcontent-%COMP%]:last-child{border-bottom:1px solid #e0e0e0}"]}),Z=(0,P.gn)([(0,c.c)()],Z);const de=[{path:"",component:b,children:[{path:"maintenance",component:x,data:{title:"Personal Profile"}},{path:"documents",component:y,data:{title:"Personal Documents"}},{path:"occupancy",component:Z,data:{title:"Occupancy Transaction"}}]}];let fe=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.Bz.forChild(de)],g.Bz]}),o})();var he=s(1470),ge=s(9112);const _e=[f.ez,fe,K.m,tt.O,he.yI.forRoot($.ik),ge.I$];let ve=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[f.ez,_e]]}),o})()}}]);